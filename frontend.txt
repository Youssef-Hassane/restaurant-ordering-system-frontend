// File: src/api/auth.ts
import apiClient from './client';
import type { ApiResponse, AuthResponse, User } from '../types';

export const authApi = {
  login: async (email: string, password: string): Promise<AuthResponse> => {
    const response = await apiClient.post<ApiResponse<AuthResponse>>('/auth/login', {
      email,
      password
    });
    return response.data.data!;
  },

  logout: async (): Promise<void> => {
    const refreshToken = localStorage.getItem('refreshToken');
    await apiClient.post('/auth/logout', { refreshToken });
    localStorage.removeItem('accessToken');
    localStorage.removeItem('refreshToken');
  },

  getMe: async (): Promise<User> => {
    const response = await apiClient.get<ApiResponse<User>>('/auth/me');
    return response.data.data!;
  },

  refreshToken: async (refreshToken: string): Promise<{ accessToken: string; refreshToken: string }> => {
    const response = await apiClient.post<ApiResponse<{ accessToken: string; refreshToken: string }>>('/auth/refresh', {
      refreshToken
    });
    return response.data.data!;
  }
};
// File: src/api/client.ts
import axios, { AxiosError } from 'axios';
import type { InternalAxiosRequestConfig } from 'axios';

const API_URL = import.meta.env.VITE_API_URL || '/api';

export const apiClient = axios.create({
  baseURL: API_URL,
  headers: {
    'Content-Type': 'application/json',
  },
});

// Request interceptor to add auth token
apiClient.interceptors.request.use(
  (config: InternalAxiosRequestConfig) => {
    const token = localStorage.getItem('accessToken');
    if (token && config.headers) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => Promise.reject(error)
);

// Response interceptor for token refresh
apiClient.interceptors.response.use(
  (response) => response,
  async (error: AxiosError) => {
    const originalRequest = error.config as InternalAxiosRequestConfig & { _retry?: boolean };
    
    if (error.response?.status === 401 && !originalRequest._retry) {
      originalRequest._retry = true;
      
      const refreshToken = localStorage.getItem('refreshToken');
      
      if (refreshToken) {
        try {
          const response = await axios.post(`${API_URL}/auth/refresh`, {
            refreshToken
          });
          
          const { accessToken, refreshToken: newRefreshToken } = response.data.data;
          
          localStorage.setItem('accessToken', accessToken);
          localStorage.setItem('refreshToken', newRefreshToken);
          
          if (originalRequest.headers) {
            originalRequest.headers.Authorization = `Bearer ${accessToken}`;
          }
          
          return apiClient(originalRequest);
        } catch (refreshError) {
          localStorage.removeItem('accessToken');
          localStorage.removeItem('refreshToken');
          window.location.href = '/login';
        }
      }
    }
    
    return Promise.reject(error);
  }
);

export default apiClient;
// File: src/api/orders.ts
import apiClient from './client';
import type { ApiResponse, Order, OrderWithItems, CreateOrderRequest, OrderStatus } from '../types';

export const ordersApi = {
  create: async (orderData: CreateOrderRequest): Promise<Order> => {
    const response = await apiClient.post<ApiResponse<Order>>('/orders', orderData);
    return response.data.data!;
  },

  getAll: async (status?: OrderStatus): Promise<Order[]> => {
    const params = status ? `?status=${status}` : '';
    const response = await apiClient.get<ApiResponse<Order[]>>(`/orders${params}`);
    return response.data.data || [];
  },

  getById: async (id: string): Promise<OrderWithItems> => {
    const response = await apiClient.get<ApiResponse<OrderWithItems>>(`/orders/${id}`);
    return response.data.data!;
  },

  updateStatus: async (id: string, status: OrderStatus): Promise<Order> => {
    const response = await apiClient.patch<ApiResponse<Order>>(`/orders/${id}/status`, { status });
    return response.data.data!;
  },

  delete: async (id: string): Promise<void> => {
    await apiClient.delete(`/orders/${id}`);
  }
};
// File: src/api/products.ts
import apiClient from './client';
import type { ApiResponse, Product, CreateProductRequest } from '../types';

export interface ProductFilters {
  category?: string;
  available?: boolean;
  search?: string;
  currency?: string;
}

export const productsApi = {
  getAll: async (filters?: ProductFilters): Promise<Product[]> => {
    const params = new URLSearchParams();
    
    if (filters?.category) params.append('category', filters.category);
    if (filters?.available !== undefined) params.append('available', String(filters.available));
    if (filters?.search) params.append('search', filters.search);
    if (filters?.currency) params.append('currency', filters.currency);
    
    const response = await apiClient.get<ApiResponse<Product[]>>(`/products?${params.toString()}`);
    return response.data.data || [];
  },

  getById: async (id: string): Promise<Product> => {
    const response = await apiClient.get<ApiResponse<Product>>(`/products/${id}`);
    return response.data.data!;
  },

  getCategories: async (): Promise<string[]> => {
    const response = await apiClient.get<ApiResponse<string[]>>('/products/categories');
    return response.data.data || [];
  },

  getCurrencies: async (): Promise<{ code: string; symbol: string; isDefault: boolean }[]> => {
    const response = await apiClient.get<ApiResponse<{ code: string; symbol: string; isDefault: boolean }[]>>('/products/currencies');
    return response.data.data || [];
  },

  create: async (productData: CreateProductRequest): Promise<Product> => {
    const response = await apiClient.post<ApiResponse<Product>>('/products', productData);
    return response.data.data!;
  },

  update: async (id: string, productData: CreateProductRequest): Promise<Product> => {
    const response = await apiClient.put<ApiResponse<Product>>(`/products/${id}`, productData);
    return response.data.data!;
  },

  patch: async (id: string, productData: Partial<CreateProductRequest>): Promise<Product> => {
    const response = await apiClient.patch<ApiResponse<Product>>(`/products/${id}`, productData);
    return response.data.data!;
  },

  delete: async (id: string): Promise<void> => {
    await apiClient.delete(`/products/${id}`);
  },

  toggleAvailability: async (id: string, available: boolean): Promise<Product> => {
    const response = await apiClient.patch<ApiResponse<Product>>(`/products/${id}/availability`, { available });
    return response.data.data!;
  }
};
// File: src/App.css
#root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}

// File: src/App.tsx
import { Routes, Route } from 'react-router-dom';
import Layout from './components/layout/Layout';
import HomePage from './pages/HomePage';
import LoginPage from './pages/LoginPage';
import OrderSuccessPage from './pages/OrderSuccessPage';
import AdminProductsPage from './pages/AdminProductsPage';
import AdminOrdersPage from './pages/AdminOrdersPage';
import ProtectedRoute from './components/auth/ProtectedRoute';

function App() {
  return (
    <Routes>
      <Route path="/" element={<Layout />}>
        <Route index element={<HomePage />} />
        <Route path="login" element={<LoginPage />} />
        <Route path="order-success" element={<OrderSuccessPage />} />
        
        {/* Admin/Manager Only: Product Management */}
        <Route path="admin/products" element={
          <ProtectedRoute allowedRoles={['admin', 'manager']}>
            <AdminProductsPage />
          </ProtectedRoute>
        } />
        
        {/* All Staff: Order Management */}
        <Route path="admin/orders" element={
          <ProtectedRoute allowedRoles={['admin', 'manager', 'cashier']}>
            <AdminOrdersPage />
          </ProtectedRoute>
        } />
      </Route>
    </Routes>
  );
}

export default App;
// File: src/components/auth/ProtectedRoute.tsx
import { Navigate, useLocation } from 'react-router-dom';
import { useAuth } from '../../context/AuthContext';
import type { UserRole } from '../../types';
import Spinner from '../ui/Spinner';

interface ProtectedRouteProps {
  children: React.ReactNode;
  allowedRoles?: UserRole[];
}

export default function ProtectedRoute({ children, allowedRoles }: ProtectedRouteProps) {
  const { isAuthenticated, isLoading, user } = useAuth();
  const location = useLocation();

  if (isLoading) {
    return (
      <div className="min-h-[60vh] flex items-center justify-center">
        <Spinner size="lg" />
      </div>
    );
  }

  if (!isAuthenticated) {
    return <Navigate to="/login" state={{ from: location }} replace />;
  }

  if (allowedRoles && user && !allowedRoles.includes(user.role)) {
    return (
      <div className="min-h-[60vh] flex flex-col items-center justify-center">
        <h1 className="text-2xl font-bold text-gray-900 dark:text-white mb-2">Access Denied</h1>
        <p className="text-gray-600 dark:text-gray-400 mb-4">
          You don't have permission to access this page.
        </p>
        <p className="text-sm text-gray-500 dark:text-gray-500">
          Required role: {allowedRoles.join(' or ')} | Your role: {user.role}
        </p>
      </div>
    );
  }

  return <>{children}</>;
}
// File: src/components/cart/CartDrawer.tsx
import { useEffect, useState } from 'react';
import { X, ShoppingBag } from 'lucide-react';
import { useTranslation } from 'react-i18next';
import { useCart } from '../../context/CartContext';
import { useLanguage } from '../../context/LanguageContext';
import CartItem from './CartItem';
import CartSummary from './CartSummary';
import OrderForm from '../orders/OrderForm';
import Button from '../ui/Button';

export default function CartDrawer() {
  const { isOpen, closeCart, items, clearCart } = useCart();
  const [showOrderForm, setShowOrderForm] = useState(false);
  const { t } = useTranslation();
  const { isRTL } = useLanguage();

  useEffect(() => {
    if (isOpen) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = 'unset';
      setShowOrderForm(false);
    }
    
    return () => {
      document.body.style.overflow = 'unset';
    };
  }, [isOpen]);

  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 z-50">
      {/* Backdrop */}
      <div
        className="absolute inset-0 bg-black/50 backdrop-blur-sm"
        onClick={closeCart}
      />
      
      {/* Drawer */}
      <div className={`absolute top-0 h-full w-full max-w-md bg-white dark:bg-gray-900 shadow-xl flex flex-col animate-slide-in-right ${isRTL ? 'left-0' : 'right-0'}`}>
        {/* Header */}
        <div className="flex items-center justify-between p-4 border-b dark:border-gray-800">
          <div className="flex items-center space-x-2 rtl:space-x-reverse">
            <ShoppingBag className="w-5 h-5 text-brand-gold" />
            <h2 className="text-lg font-semibold">{t('cart.title')}</h2>
          </div>
          <button
            onClick={closeCart}
            className="p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full transition-colors"
          >
            <X className="w-5 h-5" />
          </button>
        </div>
        
        {/* Content */}
        <div className="flex-1 overflow-auto p-4">
          {items.length === 0 ? (
            <div className="flex flex-col items-center justify-center h-full text-center">
              <ShoppingBag className="w-16 h-16 text-gray-300 dark:text-gray-600 mb-4" />
              <p className="text-gray-500 dark:text-gray-400 mb-2">{t('cart.empty')}</p>
              <p className="text-sm text-gray-400 dark:text-gray-500">
                {t('cart.emptySubtitle')}
              </p>
            </div>
          ) : showOrderForm ? (
            <OrderForm onCancel={() => setShowOrderForm(false)} />
          ) : (
            <div className="divide-y dark:divide-gray-800">
              {items.map(item => (
                <CartItem key={item.product.id} item={item} />
              ))}
            </div>
          )}
        </div>
        
        {/* Footer */}
        {items.length > 0 && !showOrderForm && (
          <div className="p-4 border-t dark:border-gray-800">
            <CartSummary />
            
            <div className="mt-4 space-y-2">
              <Button
                onClick={() => setShowOrderForm(true)}
                className="w-full"
                size="lg"
              >
                {t('cart.checkout')}
              </Button>
              
              <Button
                onClick={clearCart}
                variant="ghost"
                className="w-full text-red-500 hover:text-red-600"
              >
                {t('cart.clearCart')}
              </Button>
            </div>
          </div>
        )}
      </div>
    </div>
  );
}
// File: src/components/cart/CartItem.tsx
import { Minus, Plus, Trash2 } from 'lucide-react';
import type { CartItem as CartItemType } from '../../types';
import { formatPrice } from '../../utils/currency';
import { useCart } from '../../context/CartContext';

interface CartItemProps {
  item: CartItemType;
}

export default function CartItem({ item }: CartItemProps) {
  const { updateQuantity, removeItem } = useCart();
  const { product, quantity } = item;

  return (
    <div className="flex items-start space-x-3 py-3">
      <div className="w-16 h-16 rounded-lg overflow-hidden flex-shrink-0">
        {product.image_url ? (
          <img
            src={product.image_url}
            alt={product.name}
            className="w-full h-full object-cover"
          />
        ) : (
          <div className="w-full h-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center">
            <span className="text-2xl">üçΩÔ∏è</span>
          </div>
        )}
      </div>
      
      <div className="flex-1 min-w-0">
        <h4 className="font-medium text-gray-900 dark:text-white truncate">
          {product.name}
        </h4>
        <p className="text-sm text-brand-gold font-semibold">
          {formatPrice(product.price, product.currency)}
        </p>
        
        <div className="flex items-center space-x-2 mt-2">
          <button
            onClick={() => updateQuantity(product.id, quantity - 1)}
            className="p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors"
          >
            <Minus className="w-4 h-4" />
          </button>
          
          <span className="w-8 text-center font-medium">{quantity}</span>
          
          <button
            onClick={() => updateQuantity(product.id, quantity + 1)}
            className="p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors"
          >
            <Plus className="w-4 h-4" />
          </button>
          
          <button
            onClick={() => removeItem(product.id)}
            className="p-1 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded ml-auto transition-colors"
          >
            <Trash2 className="w-4 h-4" />
          </button>
        </div>
      </div>
      
      <div className="text-right flex-shrink-0">
        <span className="font-semibold text-gray-900 dark:text-white">
          {formatPrice(product.price * quantity, product.currency)}
        </span>
      </div>
    </div>
  );
}
// File: src/components/cart/CartSummary.tsx
import { useCart } from '../../context/CartContext';
import { formatPrice } from '../../utils/currency';

export default function CartSummary() {
  const { total, currency, itemCount } = useCart();

  return (
    <div className="border-t dark:border-gray-700 pt-4 mt-4">
      <div className="flex justify-between items-center mb-2">
        <span className="text-gray-600 dark:text-gray-400">Items</span>
        <span className="font-medium">{itemCount}</span>
      </div>
      
      <div className="flex justify-between items-center">
        <span className="text-lg font-semibold">Total</span>
        <span className="text-2xl font-bold text-brand-gold">
          {formatPrice(total, currency)}
        </span>
      </div>
    </div>
  );
}
// File: src/components/layout/Footer.tsx
import { useTranslation } from 'react-i18next';
import { useLanguage } from '../../context/LanguageContext';

export default function Footer() {
  const { t } = useTranslation();
  const { isRTL } = useLanguage();

  return (
    <footer className="bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div className="flex flex-col md:flex-row justify-between items-center">
          <div className="flex items-center space-x-2 rtl:space-x-reverse mb-4 md:mb-0">
            <div className="w-8 h-8 bg-brand-black dark:bg-white rounded-lg flex items-center justify-center">
              <span className="text-white dark:text-brand-black font-bold">O</span>
            </div>
            <span className="font-bold text-gray-900 dark:text-white">
              {isRTL ? (
                <>ÿ£Ÿàÿ±ÿØÿ±<span className="text-brand-gold">ŸÉŸäŸÜÿ¨</span></>
              ) : (
                <>RDER<span className="text-brand-gold">KING</span></>
              )}
            </span>
          </div>
          
          <p className="text-sm text-gray-500 dark:text-gray-400">
            {t('footer.copyright', { year: new Date().getFullYear() })}
          </p>
        </div>
      </div>
    </footer>
  );
}
// File: src/components/layout/Header.tsx
import { Link, useLocation } from 'react-router-dom';
import { ShoppingCart, Sun, Moon, User, Menu, X, Package, ClipboardList } from 'lucide-react';
import { useState } from 'react';
import { useTranslation } from 'react-i18next';
import { useCart } from '../../context/CartContext';
import { useTheme } from '../../context/ThemeContext';
import { useAuth } from '../../context/AuthContext';
import { useLanguage } from '../../context/LanguageContext';
import LanguageSwitcher from '../ui/LanguageSwitcher';

export default function Header() {
  const { itemCount, openCart } = useCart();
  const { theme, toggleTheme } = useTheme();
  const { isAuthenticated, user, logout } = useAuth();
  const { isRTL } = useLanguage();
  const { t } = useTranslation();
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
  const location = useLocation();

  const canManageProducts = user?.role === 'admin' || user?.role === 'manager';
  const canManageOrders = user?.role === 'admin' || user?.role === 'manager' || user?.role === 'cashier';

  return (
    <header className="sticky top-0 z-40 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex items-center justify-between h-16">
          {/* Logo */}
          <Link to="/" className="flex items-center space-x-2 rtl:space-x-reverse">
            <div className="relative">
              <div className="w-10 h-10 bg-brand-black dark:bg-white rounded-lg flex items-center justify-center">
                <span className="text-white dark:text-brand-black font-bold text-lg">O</span>
              </div>
              <div className="absolute -top-1 left-1/2 -translate-x-1/2 w-4 h-2">
                <svg viewBox="0 0 16 8" fill="none" className="w-full h-full">
                  <path d="M8 0L10 4H6L8 0Z" fill="#C9A227" />
                  <path d="M4 2L6 6H2L4 2Z" fill="#C9A227" />
                  <path d="M12 2L14 6H10L12 2Z" fill="#C9A227" />
                </svg>
              </div>
            </div>
            <span className="text-xl font-bold text-gray-900 dark:text-white">
              {isRTL ? (
                <>ÿ£Ÿàÿ±ÿØÿ±<span className="text-brand-gold">ŸÉŸäŸÜÿ¨</span></>
              ) : (
                <>RDER<span className="text-brand-gold">KING</span></>
              )}
            </span>
          </Link>

          {/* Desktop Navigation */}
          <nav className="hidden md:flex items-center space-x-4 rtl:space-x-reverse">
            {isAuthenticated && canManageProducts && (
              <Link
                to="/admin/products"
                className={`flex items-center space-x-1 rtl:space-x-reverse px-3 py-2 rounded-lg transition-colors ${
                  location.pathname === '/admin/products'
                    ? 'bg-brand-gold text-white'
                    : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800'
                }`}
              >
                <Package className="w-4 h-4" />
                <span className="text-sm">{t('nav.products')}</span>
              </Link>
            )}

            {isAuthenticated && canManageOrders && (
              <Link
                to="/admin/orders"
                className={`flex items-center space-x-1 rtl:space-x-reverse px-3 py-2 rounded-lg transition-colors ${
                  location.pathname === '/admin/orders'
                    ? 'bg-brand-gold text-white'
                    : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800'
                }`}
              >
                <ClipboardList className="w-4 h-4" />
                <span className="text-sm">{t('nav.orders')}</span>
              </Link>
            )}

            {/* Language Switcher */}
            <LanguageSwitcher />

            {/* Theme Toggle */}
            <button
              onClick={toggleTheme}
              className="p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors"
              aria-label={theme === 'light' ? t('nav.darkMode') : t('nav.lightMode')}
            >
              {theme === 'light' ? (
                <Moon className="w-5 h-5 text-gray-600 dark:text-gray-400" />
              ) : (
                <Sun className="w-5 h-5 text-gray-600 dark:text-gray-400" />
              )}
            </button>

            {isAuthenticated ? (
              <div className="flex items-center space-x-3 rtl:space-x-reverse">
                <div className="flex items-center space-x-2 rtl:space-x-reverse px-3 py-1 bg-gray-100 dark:bg-gray-800 rounded-full">
                  <div className="w-6 h-6 bg-brand-gold rounded-full flex items-center justify-center">
                    <span className="text-white text-xs font-bold">
                      {user?.name?.charAt(0).toUpperCase()}
                    </span>
                  </div>
                  <div className="flex flex-col">
                    <span className="text-sm text-gray-700 dark:text-gray-300">
                      {user?.name}
                    </span>
                    <span className="text-xs text-gray-500 dark:text-gray-400 capitalize">
                      {user?.role}
                    </span>
                  </div>
                </div>
                <button
                  onClick={logout}
                  className="text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"
                >
                  {t('nav.logout')}
                </button>
              </div>
            ) : (
              <Link
                to="/login"
                className="flex items-center space-x-1 rtl:space-x-reverse text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"
              >
                <User className="w-5 h-5" />
                <span className="text-sm">{t('nav.login')}</span>
              </Link>
            )}

            <button
              onClick={openCart}
              className="relative p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors"
              aria-label={t('cart.title')}
            >
              <ShoppingCart className="w-6 h-6 text-gray-600 dark:text-gray-400" />
              {itemCount > 0 && (
                <span className="absolute -top-1 -end-1 bg-brand-gold text-white text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center">
                  {itemCount}
                </span>
              )}
            </button>
          </nav>

          {/* Mobile menu button */}
          <div className="flex md:hidden items-center space-x-2 rtl:space-x-reverse">
            <LanguageSwitcher />
            <button onClick={openCart} className="relative p-2">
              <ShoppingCart className="w-6 h-6 text-gray-600 dark:text-gray-400" />
              {itemCount > 0 && (
                <span className="absolute -top-1 -end-1 bg-brand-gold text-white text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center">
                  {itemCount}
                </span>
              )}
            </button>
            <button onClick={() => setMobileMenuOpen(!mobileMenuOpen)} className="p-2">
              {mobileMenuOpen ? (
                <X className="w-6 h-6 text-gray-600 dark:text-gray-400" />
              ) : (
                <Menu className="w-6 h-6 text-gray-600 dark:text-gray-400" />
              )}
            </button>
          </div>
        </div>

        {/* Mobile menu */}
        {mobileMenuOpen && (
          <div className="md:hidden py-4 border-t dark:border-gray-800">
            <div className="flex flex-col space-y-3">
              {isAuthenticated && canManageProducts && (
                <Link
                  to="/admin/products"
                  className="flex items-center space-x-2 rtl:space-x-reverse px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"
                  onClick={() => setMobileMenuOpen(false)}
                >
                  <Package className="w-5 h-5 text-gray-600 dark:text-gray-400" />
                  <span className="text-gray-700 dark:text-gray-300">{t('nav.products')}</span>
                </Link>
              )}
              
              {isAuthenticated && canManageOrders && (
                <Link
                  to="/admin/orders"
                  className="flex items-center space-x-2 rtl:space-x-reverse px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"
                  onClick={() => setMobileMenuOpen(false)}
                >
                  <ClipboardList className="w-5 h-5 text-gray-600 dark:text-gray-400" />
                  <span className="text-gray-700 dark:text-gray-300">{t('nav.orders')}</span>
                </Link>
              )}
              
              <button
                onClick={toggleTheme}
                className="flex items-center space-x-2 rtl:space-x-reverse px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"
              >
                {theme === 'light' ? (
                  <Moon className="w-5 h-5 text-gray-600" />
                ) : (
                  <Sun className="w-5 h-5 text-gray-400" />
                )}
                <span className="text-gray-700 dark:text-gray-300">
                  {theme === 'light' ? t('nav.darkMode') : t('nav.lightMode')}
                </span>
              </button>
              
              {isAuthenticated ? (
                <>
                  <div className="px-2 py-2 text-sm text-gray-600 dark:text-gray-400">
                    <span className="font-medium text-gray-900 dark:text-white">{user?.name}</span>
                    <span className="ms-1 text-xs capitalize">({user?.role})</span>
                  </div>
                  <button
                    onClick={() => {
                      logout();
                      setMobileMenuOpen(false);
                    }}
                    className="px-2 py-2 text-start text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"
                  >
                    {t('nav.logout')}
                  </button>
                </>
              ) : (
                <Link
                  to="/login"
                  className="flex items-center space-x-2 rtl:space-x-reverse px-2 py-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg"
                  onClick={() => setMobileMenuOpen(false)}
                >
                  <User className="w-5 h-5 text-gray-600 dark:text-gray-400" />
                  <span className="text-gray-700 dark:text-gray-300">{t('nav.login')}</span>
                </Link>
              )}
            </div>
          </div>
        )}
      </div>
    </header>
  );
}
// File: src/components/layout/Layout.tsx
import { Outlet } from 'react-router-dom';
import Header from './Header';
import Footer from './Footer';
import CartDrawer from '../cart/CartDrawer';

export default function Layout() {
  return (
    <div className="min-h-screen flex flex-col">
      <Header />
      <main className="flex-1">
        <Outlet />
      </main>
      <Footer />
      <CartDrawer />
    </div>
  );
}
// File: src/components/orders/OrderForm.tsx
import { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { ArrowLeft, Send } from 'lucide-react';
import { useCart } from '../../context/CartContext';
import { useToast } from '../../hooks/useToast';
import { ordersApi } from '../../api/orders';
import { formatPrice } from '../../utils/currency';
import Button from '../ui/Button';
import Input from '../ui/Input';

interface OrderFormProps {
  onCancel: () => void;
}

interface FormData {
  customer_name: string;
  customer_email: string;
  customer_phone: string;
  notes: string;
}

interface FormErrors {
  customer_name?: string;
  customer_email?: string;
  customer_phone?: string;
}

export default function OrderForm({ onCancel }: OrderFormProps) {
  const navigate = useNavigate();
  const { items, total, currency, clearCart, closeCart } = useCart();
  const { showToast } = useToast();
  
  const [formData, setFormData] = useState<FormData>({
    customer_name: '',
    customer_email: '',
    customer_phone: '',
    notes: ''
  });
  
  const [errors, setErrors] = useState<FormErrors>({});
  const [isSubmitting, setIsSubmitting] = useState(false);

  const validateForm = (): boolean => {
    const newErrors: FormErrors = {};
    
    if (!formData.customer_name.trim()) {
      newErrors.customer_name = 'Name is required';
    } else if (formData.customer_name.trim().length < 2) {
      newErrors.customer_name = 'Name must be at least 2 characters';
    }
    
    if (formData.customer_email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(formData.customer_email)) {
        newErrors.customer_email = 'Invalid email format';
      }
    }
    
    if (formData.customer_phone) {
      const phoneRegex = /^[\d\s\-+()]{7,20}$/;
      if (!phoneRegex.test(formData.customer_phone)) {
        newErrors.customer_phone = 'Invalid phone number format';
      }
    }
    
    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
    
    // Clear error when user starts typing
    if (errors[name as keyof FormErrors]) {
      setErrors(prev => ({ ...prev, [name]: undefined }));
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (!validateForm()) return;
    
    setIsSubmitting(true);
    
    try {
      const orderData = {
        customer_name: formData.customer_name.trim(),
        customer_email: formData.customer_email.trim() || undefined,
        customer_phone: formData.customer_phone.trim() || undefined,
        notes: formData.notes.trim() || undefined,
        items: items.map(item => ({
          product_id: item.product.id,
          quantity: item.quantity
        }))
      };
      
      const order = await ordersApi.create(orderData);
      
      showToast('success', `Order #${order.order_number} placed successfully!`);
      clearCart();
      closeCart();
      navigate('/order-success', { state: { order } });
    } catch (error: any) {
      const message = error.response?.data?.error || 'Failed to place order. Please try again.';
      showToast('error', message);
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <div className="space-y-4">
      <button
        onClick={onCancel}
        className="flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors"
      >
        <ArrowLeft className="w-4 h-4 mr-1" />
        Back to Cart
      </button>
      
      <h3 className="text-lg font-semibold">Customer Information</h3>
      
      <form onSubmit={handleSubmit} className="space-y-4">
        <Input
          label="Name *"
          name="customer_name"
          value={formData.customer_name}
          onChange={handleChange}
          placeholder="Enter your name"
          error={errors.customer_name}
          disabled={isSubmitting}
        />
        
        <Input
          label="Email (optional)"
          name="customer_email"
          type="email"
          value={formData.customer_email}
          onChange={handleChange}
          placeholder="email@example.com"
          error={errors.customer_email}
          disabled={isSubmitting}
        />
        
        <Input
          label="Phone (optional)"
          name="customer_phone"
          type="tel"
          value={formData.customer_phone}
          onChange={handleChange}
          placeholder="+20 123 456 7890"
          error={errors.customer_phone}
          disabled={isSubmitting}
        />
        
        <div>
          <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
            Notes (optional)
          </label>
          <textarea
            name="notes"
            value={formData.notes}
            onChange={handleChange}
            placeholder="Any special instructions..."
            rows={3}
            disabled={isSubmitting}
            className="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-brand-gold focus:border-transparent outline-none transition-all resize-none"
          />
        </div>
        
        {/* Order Summary */}
        <div className="bg-gray-50 dark:bg-gray-800 rounded-lg p-4 mt-4">
          <h4 className="font-medium mb-2">Order Summary</h4>
          <div className="space-y-1 text-sm">
            {items.map(item => (
              <div key={item.product.id} className="flex justify-between">
                <span>
                  {item.product.name} √ó {item.quantity}
                </span>
                <span>{formatPrice(item.product.price * item.quantity, item.product.currency)}</span>
              </div>
            ))}
          </div>
          <div className="border-t dark:border-gray-700 mt-2 pt-2 flex justify-between font-semibold">
            <span>Total</span>
            <span className="text-brand-gold">{formatPrice(total, currency)}</span>
          </div>
        </div>
        
        <Button
          type="submit"
          isLoading={isSubmitting}
          className="w-full"
          size="lg"
        >
          <Send className="w-4 h-4 mr-2" />
          Place Order
        </Button>
      </form>
    </div>
  );
}
// File: src/components/products/CategoryFilter.tsx
import clsx from 'clsx';

interface CategoryFilterProps {
  categories: string[];
  selected: string | null;
  onSelect: (category: string | null) => void;
}

export default function CategoryFilter({ categories, selected, onSelect }: CategoryFilterProps) {
  return (
    <div className="flex flex-wrap gap-2">
      <button
        onClick={() => onSelect(null)}
        className={clsx(
          'px-4 py-2 rounded-full text-sm font-medium transition-all',
          selected === null
            ? 'bg-brand-gold text-white'
            : 'bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700'
        )}
      >
        All
      </button>
      
      {categories.map(category => (
        <button
          key={category}
          onClick={() => onSelect(category)}
          className={clsx(
            'px-4 py-2 rounded-full text-sm font-medium transition-all',
            selected === category
              ? 'bg-brand-gold text-white'
              : 'bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700'
          )}
        >
          {category}
        </button>
      ))}
    </div>
  );
}
// File: src/components/products/ProductCard.tsx
import { Plus, Check } from 'lucide-react';
import { useState } from 'react';
import { useTranslation } from 'react-i18next';
import type { Product } from '../../types';
import { formatPrice } from '../../utils/currency';
import { useCart } from '../../context/CartContext';
import { useLanguage } from '../../context/LanguageContext';
import Button from '../ui/Button';

interface ProductCardProps {
  product: Product;
}

export default function ProductCard({ product }: ProductCardProps) {
  const { addItem, items } = useCart();
  const [added, setAdded] = useState(false);
  const { t } = useTranslation();
  const { isRTL } = useLanguage();

  const cartItem = items.find(item => item.product.id === product.id);

  const handleAddToCart = () => {
    addItem(product);
    setAdded(true);
    setTimeout(() => setAdded(false), 1500);
  };

  // Translate category
  const getCategoryTranslation = (category: string) => {
    const categoryKey = category.toLowerCase().replace(/\s+/g, '');
    const translationKey = `products.categories.${categoryKey}`;
    const translated = t(translationKey);
    // If translation not found, return original
    return translated === translationKey ? category : translated;
  };

  return (
    <div className="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden group hover:shadow-lg transition-shadow duration-300">
      <div className="relative aspect-[4/3] overflow-hidden">
        {product.image_url ? (
          <img
            src={product.image_url}
            alt={product.name}
            className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
          />
        ) : (
          <div className="w-full h-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center">
            <span className="text-gray-400 text-4xl">üçΩÔ∏è</span>
          </div>
        )}
        
        {!product.available && (
          <div className="absolute inset-0 bg-black/50 flex items-center justify-center">
            <span className="bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium">
              {t('products.unavailable')}
            </span>
          </div>
        )}
        
        <div className={`absolute top-2 ${isRTL ? 'right-2' : 'left-2'}`}>
          <span className="bg-brand-gold text-white text-xs font-medium px-2 py-1 rounded-full">
            {getCategoryTranslation(product.category)}
          </span>
        </div>
      </div>
      
      <div className="p-4">
        <h3 className="font-semibold text-lg text-gray-900 dark:text-white mb-1">
          {product.name}
        </h3>
        
        {product.description && (
          <p className="text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2">
            {product.description}
          </p>
        )}
        
        <div className="flex items-center justify-between">
          <span className="text-xl font-bold text-brand-gold">
            {formatPrice(product.price, product.currency)}
          </span>
          
          <div className="flex items-center space-x-2 rtl:space-x-reverse">
            {cartItem && (
              <span className="text-sm text-gray-500 dark:text-gray-400">
                √ó{cartItem.quantity}
              </span>
            )}
            
            <Button
              onClick={handleAddToCart}
              disabled={!product.available}
              size="sm"
              variant={added ? 'secondary' : 'primary'}
              className="min-w-[100px]"
            >
              {added ? (
                <>
                  <Check className={`w-4 h-4 ${isRTL ? 'ms-1' : 'me-1'}`} />
                  {t('common.add')}
                </>
              ) : (
                <>
                  <Plus className={`w-4 h-4 ${isRTL ? 'ms-1' : 'me-1'}`} />
                  {t('common.add')}
                </>
              )}
            </Button>
          </div>
        </div>
      </div>
    </div>
  );
}
// File: src/components/products/ProductList.tsx
import type { Product } from '../../types';
import ProductCard from './ProductCard';
import Spinner from '../ui/Spinner';

interface ProductListProps {
  products: Product[];
  isLoading: boolean;
  error: string | null;
}

export default function ProductList({ products, isLoading, error }: ProductListProps) {
  if (isLoading) {
    return (
      <div className="flex justify-center items-center py-20">
        <Spinner size="lg" />
      </div>
    );
  }

  if (error) {
    return (
      <div className="text-center py-20">
        <p className="text-red-500 mb-4">{error}</p>
        <button
          onClick={() => window.location.reload()}
          className="text-brand-gold hover:underline"
        >
          Try again
        </button>
      </div>
    );
  }

  if (products.length === 0) {
    return (
      <div className="text-center py-20">
        <span className="text-6xl mb-4 block">üçΩÔ∏è</span>
        <p className="text-gray-500 dark:text-gray-400">No products found</p>
      </div>
    );
  }

  return (
    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      {products.map(product => (
        <ProductCard key={product.id} product={product} />
      ))}
    </div>
  );
}
// File: src/components/ui/Button.tsx
import type { ButtonHTMLAttributes, ReactNode } from 'react';
import clsx from 'clsx';
import Spinner from './Spinner';

interface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'primary' | 'secondary' | 'danger' | 'ghost';
  size?: 'sm' | 'md' | 'lg';
  isLoading?: boolean;
  children: ReactNode;
}

export default function Button({
  variant = 'primary',
  size = 'md',
  isLoading = false,
  disabled,
  className,
  children,
  ...props
}: ButtonProps) {
  const baseStyles = 'inline-flex items-center justify-center font-semibold rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed';
  
  const variantStyles = {
    primary: 'bg-brand-gold hover:bg-yellow-600 text-white shadow-sm',
    secondary: 'bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white',
    danger: 'bg-red-500 hover:bg-red-600 text-white',
    ghost: 'bg-transparent hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300'
  };
  
  const sizeStyles = {
    sm: 'px-3 py-1.5 text-sm',
    md: 'px-4 py-2 text-base',
    lg: 'px-6 py-3 text-lg'
  };

  return (
    <button
      className={clsx(baseStyles, variantStyles[variant], sizeStyles[size], className)}
      disabled={disabled || isLoading}
      {...props}
    >
      {isLoading && <Spinner size="sm" className="mr-2" />}
      {children}
    </button>
  );
}
// File: src/components/ui/Input.tsx
import { type InputHTMLAttributes, forwardRef } from 'react';
import clsx from 'clsx';

interface InputProps extends InputHTMLAttributes<HTMLInputElement> {
  label?: string;
  error?: string;
}

const Input = forwardRef<HTMLInputElement, InputProps>(
  ({ label, error, className, ...props }, ref) => {
    return (
      <div className="w-full">
        {label && (
          <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
            {label}
          </label>
        )}
        <input
          ref={ref}
          className={clsx(
            'w-full px-4 py-2 border rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white',
            'focus:ring-2 focus:ring-brand-gold focus:border-transparent outline-none transition-all',
            error 
              ? 'border-red-500 focus:ring-red-500' 
              : 'border-gray-300 dark:border-gray-600',
            className
          )}
          {...props}
        />
        {error && (
          <p className="mt-1 text-sm text-red-500">{error}</p>
        )}
      </div>
    );
  }
);

Input.displayName = 'Input';

export default Input;
// File: src/components/ui/LanguageSwitcher.tsx
import { Globe } from 'lucide-react';
import { useLanguage } from '../../context/LanguageContext';
import { useState, useRef, useEffect } from 'react';

export default function LanguageSwitcher() {
  const { language, changeLanguage, t } = useLanguage();
  const [isOpen, setIsOpen] = useState(false);
  const dropdownRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {
        setIsOpen(false);
      }
    };

    document.addEventListener('mousedown', handleClickOutside);
    return () => document.removeEventListener('mousedown', handleClickOutside);
  }, []);

  const languages = [
    { code: 'en' as const, name: 'English', nativeName: 'English' },
    { code: 'ar' as const, name: 'Arabic', nativeName: 'ÿßŸÑÿπÿ±ÿ®Ÿäÿ©' }
  ];

  return (
    <div className="relative" ref={dropdownRef}>
      <button
        onClick={() => setIsOpen(!isOpen)}
        className="flex items-center space-x-1 rtl:space-x-reverse p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors"
        aria-label={t('nav.language')}
      >
        <Globe className="w-5 h-5 text-gray-600 dark:text-gray-400" />
        <span className="text-sm text-gray-600 dark:text-gray-400 hidden sm:inline">
          {language === 'ar' ? 'ÿπ' : 'EN'}
        </span>
      </button>

      {isOpen && (
        <div className="absolute top-full mt-1 end-0 bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-700 py-1 min-w-[140px] z-50">
          {languages.map((lang) => (
            <button
              key={lang.code}
              onClick={() => {
                changeLanguage(lang.code);
                setIsOpen(false);
              }}
              className={`w-full px-4 py-2 text-start text-sm hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors flex items-center justify-between ${
                language === lang.code ? 'text-brand-gold font-medium' : 'text-gray-700 dark:text-gray-300'
              }`}
            >
              <span>{lang.nativeName}</span>
              {language === lang.code && (
                <span className="text-brand-gold">‚úì</span>
              )}
            </button>
          ))}
        </div>
      )}
    </div>
  );
}
// File: src/components/ui/Modal.tsx
import { type ReactNode, useEffect } from 'react';
import { X } from 'lucide-react';

interface ModalProps {
  isOpen: boolean;
  onClose: () => void;
  title?: string;
  children: ReactNode;
}

export default function Modal({ isOpen, onClose, title, children }: ModalProps) {
  useEffect(() => {
    if (isOpen) {
      document.body.style.overflow = 'hidden';
    } else {
      document.body.style.overflow = 'unset';
    }
    
    return () => {
      document.body.style.overflow = 'unset';
    };
  }, [isOpen]);

  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center">
      <div 
        className="absolute inset-0 bg-black/50 backdrop-blur-sm"
        onClick={onClose}
      />
      <div className="relative bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-auto">
        {title && (
          <div className="flex items-center justify-between p-4 border-b dark:border-gray-700">
            <h2 className="text-xl font-semibold">{title}</h2>
            <button
              onClick={onClose}
              className="p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors"
            >
              <X className="w-5 h-5" />
            </button>
          </div>
        )}
        <div className="p-4">
          {children}
        </div>
      </div>
    </div>
  );
}
// File: src/components/ui/Spinner.tsx
import clsx from 'clsx';

interface SpinnerProps {
  size?: 'sm' | 'md' | 'lg';
  className?: string;
}

export default function Spinner({ size = 'md', className }: SpinnerProps) {
  const sizeStyles = {
    sm: 'w-4 h-4',
    md: 'w-8 h-8',
    lg: 'w-12 h-12'
  };

  return (
    <div
      className={clsx(
        'animate-spin rounded-full border-2 border-gray-300 border-t-brand-gold',
        sizeStyles[size],
        className
      )}
    />
  );
}
// File: src/context/AuthContext.tsx
import { createContext, useContext, useState, useEffect, type ReactNode } from 'react';
import type { User } from '../types';
import { authApi } from '../api/auth';

interface AuthContextType {
  user: User | null;
  isLoading: boolean;
  isAuthenticated: boolean;
  login: (email: string, password: string) => Promise<void>;
  logout: () => Promise<void>;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export function AuthProvider({ children }: { children: ReactNode }) {
  const [user, setUser] = useState<User | null>(null);
  const [isLoading, setIsLoading] = useState(true);

  useEffect(() => {
    const initAuth = async () => {
      const token = localStorage.getItem('accessToken');
      if (token) {
        try {
          const userData = await authApi.getMe();
          setUser(userData);
        } catch {
          localStorage.removeItem('accessToken');
          localStorage.removeItem('refreshToken');
        }
      }
      setIsLoading(false);
    };

    initAuth();
  }, []);

  const login = async (email: string, password: string) => {
    const response = await authApi.login(email, password);
    localStorage.setItem('accessToken', response.accessToken);
    localStorage.setItem('refreshToken', response.refreshToken);
    setUser(response.user);
  };

  const logout = async () => {
    try {
      await authApi.logout();
    } catch {
      // Ignore errors, just clear local storage
    } finally {
      localStorage.removeItem('accessToken');
      localStorage.removeItem('refreshToken');
      setUser(null);
    }
  };

  return (
    <AuthContext.Provider value={{
      user,
      isLoading,
      isAuthenticated: !!user,
      login,
      logout
    }}>
      {children}
    </AuthContext.Provider>
  );
}

export function useAuth() {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  return context;
}
// File: src/context/CartContext.tsx
import { createContext, useContext, useState, useEffect, type ReactNode } from 'react';
import type { CartItem, Product, Currency } from '../types';

interface CartContextType {
  items: CartItem[];
  itemCount: number;
  total: number;
  currency: Currency;
  addItem: (product: Product, quantity?: number) => void;
  removeItem: (productId: string) => void;
  updateQuantity: (productId: string, quantity: number) => void;
  clearCart: () => void;
  isOpen: boolean;
  openCart: () => void;
  closeCart: () => void;
}

const CartContext = createContext<CartContextType | undefined>(undefined);

const CART_STORAGE_KEY = 'orderking_cart';

export function CartProvider({ children }: { children: ReactNode }) {
  const [items, setItems] = useState<CartItem[]>(() => {
    const saved = localStorage.getItem(CART_STORAGE_KEY);
    return saved ? JSON.parse(saved) : [];
  });
  const [isOpen, setIsOpen] = useState(false);

  useEffect(() => {
    localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(items));
  }, [items]);

  const addItem = (product: Product, quantity = 1) => {
    setItems(current => {
      const existing = current.find(item => item.product.id === product.id);
      
      if (existing) {
        return current.map(item =>
          item.product.id === product.id
            ? { ...item, quantity: item.quantity + quantity }
            : item
        );
      }
      
      return [...current, { product, quantity }];
    });
    setIsOpen(true);
  };

  const removeItem = (productId: string) => {
    setItems(current => current.filter(item => item.product.id !== productId));
  };

  const updateQuantity = (productId: string, quantity: number) => {
    if (quantity <= 0) {
      removeItem(productId);
      return;
    }
    
    setItems(current =>
      current.map(item =>
        item.product.id === productId
          ? { ...item, quantity }
          : item
      )
    );
  };

  const clearCart = () => {
    setItems([]);
  };

  const itemCount = items.reduce((sum, item) => sum + item.quantity, 0);
  const total = items.reduce((sum, item) => sum + (item.product.price * item.quantity), 0);
  const currency = items[0]?.product.currency || 'EGP';

  return (
    <CartContext.Provider value={{
      items,
      itemCount,
      total,
      currency,
      addItem,
      removeItem,
      updateQuantity,
      clearCart,
      isOpen,
      openCart: () => setIsOpen(true),
      closeCart: () => setIsOpen(false)
    }}>
      {children}
    </CartContext.Provider>
  );
}

export function useCart() {
  const context = useContext(CartContext);
  if (!context) {
    throw new Error('useCart must be used within a CartProvider');
  }
  return context;
}
// File: src/context/LanguageContext.tsx
import { createContext, useContext, useEffect, type ReactNode } from 'react';
import { useTranslation } from 'react-i18next';
import type { TFunction } from 'i18next';

type Language = 'en' | 'ar';

interface LanguageContextType {
  language: Language;
  isRTL: boolean;
  changeLanguage: (lang: Language) => void;
  t: TFunction;
}


const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export function LanguageProvider({ children }: { children: ReactNode }) {
  const { i18n, t } = useTranslation();
  
  const language = (i18n.language?.split('-')[0] || 'en') as Language;
  const isRTL = language === 'ar';

  useEffect(() => {
    // Update document direction and lang
    document.documentElement.dir = isRTL ? 'rtl' : 'ltr';
    document.documentElement.lang = language;
    
    // Add RTL class to body for styling
    if (isRTL) {
      document.body.classList.add('rtl');
    } else {
      document.body.classList.remove('rtl');
    }
  }, [language, isRTL]);

  const changeLanguage = (lang: Language) => {
    i18n.changeLanguage(lang);
  };

  return (
    <LanguageContext.Provider value={{ language, isRTL, changeLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
}

export function useLanguage() {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useLanguage must be used within a LanguageProvider');
  }
  return context;
}
// File: src/context/ThemeContext.tsx
import { createContext, useContext, useEffect, useState, type ReactNode } from 'react';

type Theme = 'light' | 'dark';

interface ThemeContextType {
  theme: Theme;
  toggleTheme: () => void;
}

const ThemeContext = createContext<ThemeContextType | undefined>(undefined);

export function ThemeProvider({ children }: { children: ReactNode }) {
  const [theme, setTheme] = useState<Theme>(() => {
    const saved = localStorage.getItem('theme') as Theme;
    if (saved) return saved;
    return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
  });

  useEffect(() => {
    localStorage.setItem('theme', theme);
    document.documentElement.classList.toggle('dark', theme === 'dark');
  }, [theme]);

  const toggleTheme = () => {
    setTheme(prev => prev === 'light' ? 'dark' : 'light');
  };

  return (
    <ThemeContext.Provider value={{ theme, toggleTheme }}>
      {children}
    </ThemeContext.Provider>
  );
}

export function useTheme() {
  const context = useContext(ThemeContext);
  if (!context) {
    throw new Error('useTheme must be used within a ThemeProvider');
  }
  return context;
}
// File: src/hooks/useProducts.ts
import { useState, useEffect, useCallback } from 'react';
import type { Product } from '../types';
import { productsApi, type ProductFilters } from '../api/products';

export function useProducts(initialFilters?: ProductFilters) {
  const [products, setProducts] = useState<Product[]>([]);
  const [categories, setCategories] = useState<string[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [filters, setFilters] = useState<ProductFilters>(initialFilters || { available: true });

  const fetchProducts = useCallback(async () => {
    setIsLoading(true);
    setError(null);
    
    try {
      const [productsData, categoriesData] = await Promise.all([
        productsApi.getAll(filters),
        productsApi.getCategories()
      ]);
      
      setProducts(productsData);
      setCategories(categoriesData);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Failed to fetch products');
    } finally {
      setIsLoading(false);
    }
  }, [filters]);

  useEffect(() => {
    fetchProducts();
  }, [fetchProducts]);

  const updateFilters = (newFilters: Partial<ProductFilters>) => {
    setFilters(prev => ({ ...prev, ...newFilters }));
  };

  return {
    products,
    categories,
    isLoading,
    error,
    filters,
    updateFilters,
    refetch: fetchProducts
  };
}
// File: src/hooks/useToast.tsx
import { createContext, useContext, useState, type ReactNode, useCallback } from 'react';

type ToastType = 'success' | 'error' | 'info' | 'warning';

interface Toast {
  id: string;
  type: ToastType;
  message: string;
}

interface ToastContextType {
  toasts: Toast[];
  showToast: (type: ToastType, message: string) => void;
  dismissToast: (id: string) => void;
}

const ToastContext = createContext<ToastContextType | undefined>(undefined);

export function ToastProvider({ children }: { children: ReactNode }) {
  const [toasts, setToasts] = useState<Toast[]>([]);

  const showToast = useCallback((type: ToastType, message: string) => {
    const id = Date.now().toString();
    setToasts(prev => [...prev, { id, type, message }]);
    
    setTimeout(() => {
      setToasts(prev => prev.filter(t => t.id !== id));
    }, 4000);
  }, []);

  const dismissToast = useCallback((id: string) => {
    setToasts(prev => prev.filter(t => t.id !== id));
  }, []);

  return (
    <ToastContext.Provider value={{ toasts, showToast, dismissToast }}>
      {children}
      <ToastContainer toasts={toasts} onDismiss={dismissToast} />
    </ToastContext.Provider>
  );
}

function ToastContainer({ toasts, onDismiss }: { toasts: Toast[]; onDismiss: (id: string) => void }) {
  if (toasts.length === 0) return null;

  const typeStyles: Record<ToastType, string> = {
    success: 'bg-green-500',
    error: 'bg-red-500',
    info: 'bg-blue-500',
    warning: 'bg-yellow-500'
  };

  return (
    <div className="fixed bottom-4 right-4 z-50 space-y-2">
      {toasts.map(toast => (
        <div
          key={toast.id}
          className={`${typeStyles[toast.type]} text-white px-4 py-3 rounded-lg shadow-lg flex items-center justify-between min-w-[280px] animate-slide-up`}
        >
          <span>{toast.message}</span>
          <button
            onClick={() => onDismiss(toast.id)}
            className="ml-4 text-white/80 hover:text-white"
          >
            ‚úï
          </button>
        </div>
      ))}
    </div>
  );
}

export function useToast() {
  const context = useContext(ToastContext);
  if (!context) {
    throw new Error('useToast must be used within a ToastProvider');
  }
  return context;
}
// File: src/i18n/index.ts

// File: src/i18n/locales/ar.json
{
  "common": {
    "appName": "ÿ£Ÿàÿ±ÿØÿ± ŸÉŸäŸÜÿ¨",
    "loading": "ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...",
    "error": "ÿÆÿ∑ÿ£",
    "success": "ŸÜÿ¨ÿßÿ≠",
    "cancel": "ÿ•ŸÑÿ∫ÿßÿ°",
    "save": "ÿ≠ŸÅÿ∏",
    "delete": "ÿ≠ÿ∞ŸÅ",
    "edit": "ÿ™ÿπÿØŸäŸÑ",
    "add": "ÿ•ÿ∂ÿßŸÅÿ©",
    "update": "ÿ™ÿ≠ÿØŸäÿ´",
    "create": "ÿ•ŸÜÿ¥ÿßÿ°",
    "search": "ÿ®ÿ≠ÿ´",
    "filter": "ÿ™ÿµŸÅŸäÿ©",
    "all": "ÿßŸÑŸÉŸÑ",
    "yes": "ŸÜÿπŸÖ",
    "no": "ŸÑÿß",
    "confirm": "ÿ™ÿ£ŸÉŸäÿØ",
    "back": "ÿ±ÿ¨Ÿàÿπ",
    "next": "ÿßŸÑÿ™ÿßŸÑŸä",
    "submit": "ÿ•ÿ±ÿ≥ÿßŸÑ",
    "close": "ÿ•ÿ∫ŸÑÿßŸÇ",
    "view": "ÿπÿ±ÿ∂",
    "actions": "ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°ÿßÿ™",
    "status": "ÿßŸÑÿ≠ÿßŸÑÿ©",
    "date": "ÿßŸÑÿ™ÿßÿ±ŸäÿÆ",
    "total": "ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä",
    "items": "ÿßŸÑÿπŸÜÿßÿµÿ±",
    "noData": "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ®ŸäÿßŸÜÿßÿ™",
    "tryAgain": "ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ"
  },
  "nav": {
    "home": "ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",
    "products": "ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™",
    "orders": "ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™",
    "login": "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ ÿßŸÑŸÖŸàÿ∏ŸÅŸäŸÜ",
    "logout": "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨",
    "darkMode": "ÿßŸÑŸàÿ∂ÿπ ÿßŸÑÿØÿßŸÉŸÜ",
    "lightMode": "ÿßŸÑŸàÿ∂ÿπ ÿßŸÑŸÅÿßÿ™ÿ≠",
    "language": "ÿßŸÑŸÑÿ∫ÿ©",
    "arabic": "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",
    "english": "English"
  },
  "home": {
    "title": "ÿ£Ÿàÿ±ÿØÿ± ŸÉŸäŸÜÿ¨",
    "subtitle": "ÿßŸÉÿ™ÿ¥ŸÅ ŸÇÿßÿ¶ŸÖÿ™ŸÜÿß ÿßŸÑŸÑÿ∞Ÿäÿ∞ÿ© Ÿàÿßÿ∑ŸÑÿ® ÿ®ŸÉŸÑ ÿ≥ŸáŸàŸÑÿ©. ŸÖŸÉŸàŸÜÿßÿ™ ÿ∑ÿßÿ≤ÿ¨ÿ©ÿå ŸÜŸÉŸáÿßÿ™ ÿ±ÿßÿ¶ÿπÿ©ÿå ÿ™ÿµŸÑ ÿ•ŸÑŸâ ÿ∑ÿßŸàŸÑÿ™ŸÉ.",
    "searchPlaceholder": "ÿßÿ®ÿ≠ÿ´ ŸÅŸä ÿßŸÑŸÇÿßÿ¶ŸÖÿ©...",
    "showingItems": "ÿπÿ±ÿ∂ {{count}} ÿπŸÜÿµÿ±",
    "showingItems_plural": "ÿπÿ±ÿ∂ {{count}} ÿπŸÜÿßÿµÿ±",
    "inCategory": "ŸÅŸä {{category}}",
    "matching": "ŸÖÿ∑ÿßÿ®ŸÇ ŸÑŸÄ \"{{query}}\""
  },
  "products": {
    "title": "ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™",
    "subtitle": "ÿ•ÿ∂ÿßŸÅÿ©ÿå ÿ™ÿπÿØŸäŸÑÿå ÿ£Ÿà ÿ≠ÿ∞ŸÅ ÿπŸÜÿßÿµÿ± ÿßŸÑŸÇÿßÿ¶ŸÖÿ©",
    "addProduct": "ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸÜÿ™ÿ¨",
    "editProduct": "ÿ™ÿπÿØŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨",
    "deleteProduct": "ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖŸÜÿ™ÿ¨",
    "searchPlaceholder": "ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™...",
    "productName": "ÿßÿ≥ŸÖ ÿßŸÑŸÖŸÜÿ™ÿ¨",
    "description": "ÿßŸÑŸàÿµŸÅ",
    "price": "ÿßŸÑÿ≥ÿπÿ±",
    "category": "ÿßŸÑŸÅÿ¶ÿ©",
    "imageUrl": "ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿµŸàÿ±ÿ©",
    "available": "ŸÖÿ™ŸàŸÅÿ±",
    "unavailable": "ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÅÿ±",
    "availableForOrdering": "ŸÖÿ™ÿßÿ≠ ŸÑŸÑÿ∑ŸÑÿ®",
    "noProducts": "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÜÿ™ÿ¨ÿßÿ™",
    "deleteConfirm": "ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ≠ÿ∞ŸÅ Ÿáÿ∞ÿß ÿßŸÑŸÖŸÜÿ™ÿ¨ÿü ŸÑÿß ŸäŸÖŸÉŸÜ ÿßŸÑÿ™ÿ±ÿßÿ¨ÿπ ÿπŸÜ Ÿáÿ∞ÿß ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°.",
    "managerNote": "(ÿßŸÑŸÖÿØŸäÿ±ŸàŸÜ ŸÑÿß ŸäŸÖŸÉŸÜŸáŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™)",
    "categories": {
      "appetizers": "ÿßŸÑŸÖŸÇÿ®ŸÑÿßÿ™",
      "mainCourses": "ÿßŸÑÿ£ÿ∑ÿ®ÿßŸÇ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©",
      "desserts": "ÿßŸÑÿ≠ŸÑŸàŸäÿßÿ™",
      "beverages": "ÿßŸÑŸÖÿ¥ÿ±Ÿàÿ®ÿßÿ™"
    },
    "messages": {
      "created": "ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ®ŸÜÿ¨ÿßÿ≠",
      "updated": "ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ®ŸÜÿ¨ÿßÿ≠",
      "deleted": "ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ®ŸÜÿ¨ÿßÿ≠",
      "enabled": "ÿ™ŸÖ ÿ™ŸÅÿπŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨",
      "disabled": "ÿ™ŸÖ ÿ™ÿπÿ∑ŸäŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨"
    }
  },
  "cart": {
    "title": "ÿ≥ŸÑÿ© ÿßŸÑÿ™ÿ≥ŸàŸÇ",
    "empty": "ÿ≥ŸÑÿ™ŸÉ ŸÅÿßÿ±ÿ∫ÿ©",
    "emptySubtitle": "ÿ£ÿ∂ŸÅ ÿ®ÿπÿ∂ ÿßŸÑÿ£ÿ∑ÿ®ÿßŸÇ ÿßŸÑŸÑÿ∞Ÿäÿ∞ÿ© ŸÖŸÜ ŸÇÿßÿ¶ŸÖÿ™ŸÜÿß!",
    "checkout": "ÿ•ÿ™ŸÖÿßŸÖ ÿßŸÑÿ∑ŸÑÿ®",
    "clearCart": "ÿ•ŸÅÿ±ÿßÿ∫ ÿßŸÑÿ≥ŸÑÿ©",
    "itemCount": "{{count}} ÿπŸÜÿµÿ±",
    "itemCount_plural": "{{count}} ÿπŸÜÿßÿµÿ±"
  },
  "orders": {
    "title": "ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™",
    "subtitle": "ÿπÿ±ÿ∂ Ÿàÿ•ÿØÿßÿ±ÿ© ÿ¨ŸÖŸäÿπ ÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑÿπŸÖŸÑÔøΩÔøΩÿ°",
    "orderNumber": "ÿ±ŸÇŸÖ ÿßŸÑÿ∑ŸÑÿ®",
    "customer": "ÿßŸÑÿπŸÖŸäŸÑ",
    "customerName": "ÿßÿ≥ŸÖ ÿßŸÑÿπŸÖŸäŸÑ",
    "customerEmail": "ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä",
    "customerPhone": "ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ",
    "notes": "ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™",
    "orderDetails": "ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑÿ∑ŸÑÿ®",
    "orderItems": "ÿπŸÜÿßÿµÿ± ÿßŸÑÿ∑ŸÑÿ®",
    "customerInfo": "ŸÖÿπŸÑŸàŸÖÿßÿ™ ÿßŸÑÿπŸÖŸäŸÑ",
    "placeOrder": "ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ∑ŸÑÿ®",
    "cancelOrder": "ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿ∑ŸÑÿ®",
    "markComplete": "ÿ™ÿ≠ÿØŸäÿØ ŸÉŸÖŸÉÿ™ŸÖŸÑ",
    "deleteOrder": "ÿ≠ÿ∞ŸÅ ÿßŸÑÿ∑ŸÑÿ®",
    "deleteConfirm": "ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ≠ÿ∞ŸÅ Ÿáÿ∞ÿß ÿßŸÑÿ∑ŸÑÿ®ÿü ŸÑÿß ŸäŸÖŸÉŸÜ ÿßŸÑÿ™ÿ±ÿßÿ¨ÿπ ÿπŸÜ Ÿáÿ∞ÿß ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ°.",
    "noOrders": "ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ∑ŸÑÿ®ÿßÿ™",
    "searchPlaceholder": "ÿßŸÑÿ®ÿ≠ÿ´ ÿ®ÿßŸÑÿßÿ≥ŸÖÿå ÿ±ŸÇŸÖ ÿßŸÑÿ∑ŸÑÿ®ÿå ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸäÿå ÿ£Ÿà ÿßŸÑŸáÿßÿ™ŸÅ...",
    "allStatuses": "ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ÿßŸÑÿßÿ™",
    "backToCart": "ÿßŸÑÿπŸàÿØÿ© ŸÑŸÑÿ≥ŸÑÿ©",
    "status": {
      "pending": "ŸÇŸäÿØ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±",
      "confirmed": "ŸÖÿ§ŸÉÿØ",
      "preparing": "ŸÇŸäÿØ ÿßŸÑÿ™ÿ≠ÿ∂Ÿäÿ±",
      "ready": "ÿ¨ÿßŸáÿ≤",
      "completed": "ŸÖŸÉÿ™ŸÖŸÑ",
      "cancelled": "ŸÖŸÑÿ∫Ÿä"
    },
    "stats": {
      "pending": "ŸÇŸäÿØ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±",
      "preparing": "ŸÇŸäÿØ ÿßŸÑÿ™ÿ≠ÿ∂Ÿäÿ±",
      "ready": "ÿ¨ÿßŸáÿ≤",
      "completedToday": "ŸÖŸÉÿ™ŸÖŸÑ ÿßŸÑŸäŸàŸÖ"
    },
    "messages": {
      "placed": "ÿ™ŸÖ ÿ™ŸÇÿØŸäŸÖ ÿßŸÑÿ∑ŸÑÿ® #{{number}} ÿ®ŸÜÿ¨ÿßÿ≠!",
      "statusUpdated": "ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿ≠ÿßŸÑÿ© ÿßŸÑÿ∑ŸÑÿ® ÿ•ŸÑŸâ {{status}}",
      "deleted": "ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠",
      "cancelled": "ÿ™ŸÖ ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿ∑ŸÑÿ®"
    }
  },
  "orderSuccess": {
    "title": "ÿ™ŸÖ ÿßŸÑÿ∑ŸÑÿ®!",
    "subtitle": "ÿ¥ŸÉÿ±ÿßŸã ŸÑÿ∑ŸÑÿ®ŸÉ. ÿ≥ŸäŸÉŸàŸÜ ÿ∑ÿπÿßŸÖŸÉ ÿ¨ÿßŸáÿ≤ÿßŸã ŸÇÿ±Ÿäÿ®ÿßŸã!",
    "orderNumber": "ÿ±ŸÇŸÖ ÿßŸÑÿ∑ŸÑÿ®",
    "totalAmount": "ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä",
    "continueOrdering": "ŸÖÿ™ÿßÿ®ÿπÿ© ÿßŸÑÿ∑ŸÑÿ®"
  },
  "auth": {
    "login": "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ",
    "logout": "ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨",
    "email": "ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä",
    "password": "ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±",
    "staffLogin": "ÿØÿÆŸàŸÑ ÿßŸÑŸÖŸàÿ∏ŸÅŸäŸÜ",
    "signInToManage": "ÿ≥ÿ¨ŸÑ ÿßŸÑÿØÿÆŸàŸÑ ŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™",
    "demoCredentials": "ÿ®ŸäÿßŸÜÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©",
    "loginSuccess": "ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ŸÜÿ¨ÿßÿ≠!",
    "logoutSuccess": "ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨ ÿ®ŸÜÿ¨ÿßÿ≠",
    "invalidCredentials": "ÿ®ÿ±ŸäÿØ ÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ÿ£Ÿà ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿ©",
    "accessDenied": "ÿ™ŸÖ ÿ±ŸÅÿ∂ ÿßŸÑŸàÿµŸàŸÑ",
    "noPermission": "ŸÑŸäÿ≥ ŸÑÿØŸäŸÉ ÿµŸÑÿßÿ≠Ÿäÿ© ŸÑŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ Ÿáÿ∞Ÿá ÿßŸÑÿµŸÅÿ≠ÿ©.",
    "requiredRole": "ÿßŸÑÿØŸàÿ± ÿßŸÑŸÖÿ∑ŸÑŸàÿ®: {{roles}} | ÿØŸàÿ±ŸÉ: {{role}}"
  },
  "validation": {
    "required": "Ÿáÿ∞ÿß ÿßŸÑÿ≠ŸÇŸÑ ŸÖÿ∑ŸÑŸàÿ®",
    "invalidEmail": "ÿµŸäÿ∫ÿ© ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿ©",
    "invalidPhone": "ÿµŸäÿ∫ÿ© ÿ±ŸÇŸÖ ÿßŸÑŸáÿßÿ™ŸÅ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿ©",
    "minLength": "Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ {{min}} ÿ£ÿ≠ÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ",
    "validPrice": "ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ÿ≥ÿπÿ± ÿµÿ≠Ÿäÿ≠"
  },
  "footer": {
    "copyright": "¬© {{year}} ÿ£Ÿàÿ±ÿØÿ± ŸÉŸäŸÜÿ¨. ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÇ ŸÖÿ≠ŸÅŸàÿ∏ÿ©."
  }
}
// File: src/i18n/locales/en.json
{
  "common": {
    "appName": "OrderKing",
    "loading": "Loading...",
    "error": "Error",
    "success": "Success",
    "cancel": "Cancel",
    "save": "Save",
    "delete": "Delete",
    "edit": "Edit",
    "add": "Add",
    "update": "Update",
    "create": "Create",
    "search": "Search",
    "filter": "Filter",
    "all": "All",
    "yes": "Yes",
    "no": "No",
    "confirm": "Confirm",
    "back": "Back",
    "next": "Next",
    "submit": "Submit",
    "close": "Close",
    "view": "View",
    "actions": "Actions",
    "status": "Status",
    "date": "Date",
    "total": "Total",
    "items": "Items",
    "noData": "No data found",
    "tryAgain": "Try again"
  },
  "nav": {
    "home": "Home",
    "products": "Products",
    "orders": "Orders",
    "login": "Staff Login",
    "logout": "Logout",
    "darkMode": "Dark Mode",
    "lightMode": "Light Mode",
    "language": "Language",
    "arabic": "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",
    "english": "English"
  },
  "home": {
    "title": "OrderKing",
    "subtitle": "Discover our delicious menu and place your order with ease. Fresh ingredients, amazing flavors, delivered to your table.",
    "searchPlaceholder": "Search menu...",
    "showingItems": "Showing {{count}} item",
    "showingItems_plural": "Showing {{count}} items",
    "inCategory": "in {{category}}",
    "matching": "matching \"{{query}}\""
  },
  "products": {
    "title": "Manage Products",
    "subtitle": "Add, edit, or remove menu items",
    "addProduct": "Add Product",
    "editProduct": "Edit Product",
    "deleteProduct": "Delete Product",
    "searchPlaceholder": "Search products...",
    "productName": "Product Name",
    "description": "Description",
    "price": "Price",
    "category": "Category",
    "imageUrl": "Image URL",
    "available": "Available",
    "unavailable": "Unavailable",
    "availableForOrdering": "Available for ordering",
    "noProducts": "No products found",
    "deleteConfirm": "Are you sure you want to delete this product? This action cannot be undone.",
    "managerNote": "(Managers cannot delete products)",
    "categories": {
      "appetizers": "Appetizers",
      "mainCourses": "Main Courses",
      "desserts": "Desserts",
      "beverages": "Beverages"
    },
    "messages": {
      "created": "Product created successfully",
      "updated": "Product updated successfully",
      "deleted": "Product deleted successfully",
      "enabled": "Product enabled",
      "disabled": "Product disabled"
    }
  },
  "cart": {
    "title": "Your Cart",
    "empty": "Your cart is empty",
    "emptySubtitle": "Add some delicious items from our menu!",
    "checkout": "Proceed to Checkout",
    "clearCart": "Clear Cart",
    "itemCount": "{{count}} item",
    "itemCount_plural": "{{count}} items"
  },
  "orders": {
    "title": "Order Management",
    "subtitle": "View and manage all customer orders",
    "orderNumber": "Order #",
    "customer": "Customer",
    "customerName": "Customer Name",
    "customerEmail": "Email",
    "customerPhone": "Phone",
    "notes": "Notes",
    "orderDetails": "Order Details",
    "orderItems": "Order Items",
    "customerInfo": "Customer Information",
    "placeOrder": "Place Order",
    "cancelOrder": "Cancel Order",
    "markComplete": "Mark Complete",
    "deleteOrder": "Delete Order",
    "deleteConfirm": "Are you sure you want to delete this order? This action cannot be undone.",
    "noOrders": "No orders found",
    "searchPlaceholder": "Search by name, order #, email, or phone...",
    "allStatuses": "All Statuses",
    "backToCart": "Back to Cart",
    "status": {
      "pending": "Pending",
      "confirmed": "Confirmed",
      "preparing": "Preparing",
      "ready": "Ready",
      "completed": "Completed",
      "cancelled": "Cancelled"
    },
    "stats": {
      "pending": "Pending",
      "preparing": "Preparing",
      "ready": "Ready",
      "completedToday": "Completed Today"
    },
    "messages": {
      "placed": "Order #{{number}} placed successfully!",
      "statusUpdated": "Order status updated to {{status}}",
      "deleted": "Order deleted successfully",
      "cancelled": "Order cancelled"
    }
  },
  "orderSuccess": {
    "title": "Order Placed!",
    "subtitle": "Thank you for your order. Your food will be ready soon!",
    "orderNumber": "Order Number",
    "totalAmount": "Total Amount",
    "continueOrdering": "Continue Ordering"
  },
  "auth": {
    "login": "Sign In",
    "logout": "Logout",
    "email": "Email",
    "password": "Password",
    "staffLogin": "Staff Login",
    "signInToManage": "Sign in to manage orders",
    "demoCredentials": "Demo credentials",
    "loginSuccess": "Login successful!",
    "logoutSuccess": "Logged out successfully",
    "invalidCredentials": "Invalid email or password",
    "accessDenied": "Access Denied",
    "noPermission": "You don't have permission to access this page.",
    "requiredRole": "Required role: {{roles}} | Your role: {{role}}"
  },
  "validation": {
    "required": "This field is required",
    "invalidEmail": "Invalid email format",
    "invalidPhone": "Invalid phone number format",
    "minLength": "Must be at least {{min}} characters",
    "validPrice": "Please enter a valid price"
  },
  "footer": {
    "copyright": "¬© {{year}} OrderKing. All rights reserved."
  }
}
// File: src/index.css
@import "tailwindcss";

@theme {
  --color-primary-50: #fefce8;
  --color-primary-100: #fef9c3;
  --color-primary-200: #fef08a;
  --color-primary-300: #fde047;
  --color-primary-400: #facc15;
  --color-primary-500: #eab308;
  --color-primary-600: #ca8a04;
  --color-primary-700: #a16207;
  --color-primary-800: #854d0e;
  --color-primary-900: #713f12;
  --color-primary-950: #422006;
  
  --color-brand-gold: #C9A227;
  --color-brand-black: #1a1a1a;
  
  --font-sans: 'Inter', 'Cairo', system-ui, sans-serif;
}

/* Import Arabic font */
@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap');

/* RTL Support */
[dir="rtl"] {
  font-family: 'Cairo', 'Inter', system-ui, sans-serif;
}

/* Dark mode support */
.dark {
  color-scheme: dark;
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background-color: #f3f4f6;
}

::-webkit-scrollbar-thumb {
  background-color: #d1d5db;
  border-radius: 9999px;
}

::-webkit-scrollbar-thumb:hover {
  background-color: #9ca3af;
}

.dark ::-webkit-scrollbar-track {
  background-color: #1f2937;
}

.dark ::-webkit-scrollbar-thumb {
  background-color: #4b5563;
}

/* Animation keyframes */
@keyframes slide-up {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slide-in-right {
  from {
    transform: translateX(100%);
  }
  to {
    transform: translateX(0);
  }
}

@keyframes slide-in-left {
  from {
    transform: translateX(-100%);
  }
  to {
    transform: translateX(0);
  }
}

.animate-slide-up {
  animation: slide-up 0.3s ease-out;
}

.animate-slide-in-right {
  animation: slide-in-right 0.3s ease-out;
}

[dir="rtl"] .animate-slide-in-right {
  animation: slide-in-left 0.3s ease-out;
}

/* Line clamp utility */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* RTL-aware spacing utilities */
[dir="rtl"] .space-x-2 > :not([hidden]) ~ :not([hidden]) {
  --tw-space-x-reverse: 1;
}

[dir="rtl"] .space-x-3 > :not([hidden]) ~ :not([hidden]) {
  --tw-space-x-reverse: 1;
}

[dir="rtl"] .space-x-4 > :not([hidden]) ~ :not([hidden]) {
  --tw-space-x-reverse: 1;
}

/* RTL icon flip */
[dir="rtl"] .rtl-flip {
  transform: scaleX(-1);
}
/* :root {
  font-family: system-ui, Avenir, Helvetica, Arial, sans-serif;
  line-height: 1.5;
  font-weight: 400;

  color-scheme: light dark;
  color: rgba(255, 255, 255, 0.87);
  background-color: #242424;

  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

a {
  font-weight: 500;
  color: #646cff;
  text-decoration: inherit;
}
a:hover {
  color: #535bf2;
}

body {
  margin: 0;
  display: flex;
  place-items: center;
  min-width: 320px;
  min-height: 100vh;
}

h1 {
  font-size: 3.2em;
  line-height: 1.1;
}

button {
  border-radius: 8px;
  border: 1px solid transparent;
  padding: 0.6em 1.2em;
  font-size: 1em;
  font-weight: 500;
  font-family: inherit;
  background-color: #1a1a1a;
  cursor: pointer;
  transition: border-color 0.25s;
}
button:hover {
  border-color: #646cff;
}
button:focus,
button:focus-visible {
  outline: 4px auto -webkit-focus-ring-color;
}

@media (prefers-color-scheme: light) {
  :root {
    color: #213547;
    background-color: #ffffff;
  }
  a:hover {
    color: #747bff;
  }
  button {
    background-color: #f9f9f9;
  }
} */

// File: src/main.tsx
import React from 'react'
import ReactDOM from 'react-dom/client'
import { BrowserRouter } from 'react-router-dom'
import App from './App'
import { AuthProvider } from './context/AuthContext'
import { CartProvider } from './context/CartContext'
import { ThemeProvider } from './context/ThemeContext'
import { LanguageProvider } from './context/LanguageContext'
import { ToastProvider } from './hooks/useToast'

import './i18n'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <BrowserRouter>
      <ThemeProvider>
        <LanguageProvider>
          <ToastProvider>
            <AuthProvider>
              <CartProvider>
                <App />
              </CartProvider>
            </AuthProvider>
          </ToastProvider>
        </LanguageProvider>
      </ThemeProvider>
    </BrowserRouter>
  </React.StrictMode>,
)
// File: src/pages/AdminOrdersPage.tsx
import { useState, useEffect } from 'react';
import { Search, Eye, ChevronDown, Clock, CheckCircle, XCircle, ChefHat, Package, Trash2, AlertTriangle } from 'lucide-react';
import { Order, OrderStatus, OrderWithItems } from '../types';
import { ordersApi } from '../api/orders';
import { useToast } from '../hooks/useToast';
import { useAuth } from '../context/AuthContext';
import Button from '../components/ui/Button';
import Modal from '../components/ui/Modal';
import Spinner from '../components/ui/Spinner';
import { formatPrice } from '../utils/currency';

const STATUS_CONFIG: Record<OrderStatus, { label: string; color: string; icon: React.ReactNode }> = {
  pending: { label: 'Pending', color: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400', icon: <Clock className="w-4 h-4" /> },
  confirmed: { label: 'Confirmed', color: 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400', icon: <CheckCircle className="w-4 h-4" /> },
  preparing: { label: 'Preparing', color: 'bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400', icon: <ChefHat className="w-4 h-4" /> },
  ready: { label: 'Ready', color: 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400', icon: <Package className="w-4 h-4" /> },
  completed: { label: 'Completed', color: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300', icon: <CheckCircle className="w-4 h-4" /> },
  cancelled: { label: 'Cancelled', color: 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400', icon: <XCircle className="w-4 h-4" /> }
};

const STATUS_OPTIONS: OrderStatus[] = ['pending', 'confirmed', 'preparing', 'ready', 'completed', 'cancelled'];

export default function AdminOrdersPage() {
  const [orders, setOrders] = useState<Order[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [searchQuery, setSearchQuery] = useState('');
  const [statusFilter, setStatusFilter] = useState<OrderStatus | ''>('');
  const [selectedOrder, setSelectedOrder] = useState<OrderWithItems | null>(null);
  const [isDetailModalOpen, setIsDetailModalOpen] = useState(false);
  const [isLoadingDetail, setIsLoadingDetail] = useState(false);
  const [deleteConfirm, setDeleteConfirm] = useState<string | null>(null);
  const { showToast } = useToast();
  const { user } = useAuth();

  // Role-based permissions
  const canDeleteOrders = user?.role === 'admin' || user?.role === 'manager';

  useEffect(() => {
    fetchOrders();
  }, [statusFilter]);

  const fetchOrders = async () => {
    setIsLoading(true);
    try {
      const data = await ordersApi.getAll(statusFilter || undefined);
      setOrders(data);
    } catch (error) {
      showToast('error', 'Failed to load orders');
    } finally {
      setIsLoading(false);
    }
  };

  const filteredOrders = orders.filter(order => {
    const query = searchQuery.toLowerCase();
    return (
      order.customer_name.toLowerCase().includes(query) ||
      order.order_number.toString().includes(query) ||
      order.customer_email?.toLowerCase().includes(query) ||
      order.customer_phone?.includes(query)
    );
  });

  const viewOrderDetails = async (orderId: string) => {
    setIsLoadingDetail(true);
    setIsDetailModalOpen(true);
    try {
      const order = await ordersApi.getById(orderId);
      setSelectedOrder(order);
    } catch (error) {
      showToast('error', 'Failed to load order details');
      setIsDetailModalOpen(false);
    } finally {
      setIsLoadingDetail(false);
    }
  };

  const updateOrderStatus = async (orderId: string, newStatus: OrderStatus) => {
    try {
      await ordersApi.updateStatus(orderId, newStatus);
      showToast('success', `Order status updated to ${newStatus}`);
      fetchOrders();
      if (selectedOrder && selectedOrder.id === orderId) {
        setSelectedOrder({ ...selectedOrder, status: newStatus });
      }
    } catch (error: any) {
      showToast('error', error.response?.data?.error || 'Failed to update status');
    }
  };

  const handleDeleteOrder = async (orderId: string) => {
    try {
      await ordersApi.delete(orderId);
      showToast('success', 'Order deleted successfully');
      setDeleteConfirm(null);
      fetchOrders();
    } catch (error: any) {
      showToast('error', error.response?.data?.error || 'Failed to delete order');
    }
  };

  const formatDate = (dateString: string) => {
    return new Date(dateString).toLocaleString('en-US', {
      month: 'short',
      day: 'numeric',
      year: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  };

  if (isLoading) {
    return (
      <div className="min-h-[60vh] flex items-center justify-center">
        <Spinner size="lg" />
      </div>
    );
  }

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      {/* Header */}
      <div className="mb-8">
        <h1 className="text-2xl font-bold text-gray-900 dark:text-white">Order Management</h1>
        <p className="text-gray-600 dark:text-gray-400">
          View and manage all customer orders
          <span className="ml-2 text-sm text-brand-gold capitalize">
            ({user?.role})
          </span>
        </p>
      </div>

      {/* Filters */}
      <div className="flex flex-col sm:flex-row gap-4 mb-6">
        <div className="relative flex-1 max-w-md">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
          <input
            type="text"
            placeholder="Search by name, order #, email, or phone..."
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
            className="w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 focus:ring-2 focus:ring-brand-gold focus:border-transparent outline-none"
          />
        </div>
        
        <select
          value={statusFilter}
          onChange={(e) => setStatusFilter(e.target.value as OrderStatus | '')}
          className="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-brand-gold focus:border-transparent outline-none"
        >
          <option value="">All Statuses</option>
          {STATUS_OPTIONS.map(status => (
            <option key={status} value={status}>{STATUS_CONFIG[status].label}</option>
          ))}
        </select>
      </div>

      {/* Stats Cards */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
        <div className="bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4">
          <div className="text-yellow-600 dark:text-yellow-400 text-sm font-medium">Pending</div>
          <div className="text-2xl font-bold text-yellow-700 dark:text-yellow-300">
            {orders.filter(o => o.status === 'pending').length}
          </div>
        </div>
        <div className="bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4">
          <div className="text-purple-600 dark:text-purple-400 text-sm font-medium">Preparing</div>
          <div className="text-2xl font-bold text-purple-700 dark:text-purple-300">
            {orders.filter(o => o.status === 'preparing').length}
          </div>
        </div>
        <div className="bg-green-50 dark:bg-green-900/20 rounded-lg p-4">
          <div className="text-green-600 dark:text-green-400 text-sm font-medium">Ready</div>
          <div className="text-2xl font-bold text-green-700 dark:text-green-300">
            {orders.filter(o => o.status === 'ready').length}
          </div>
        </div>
        <div className="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
          <div className="text-gray-600 dark:text-gray-400 text-sm font-medium">Completed Today</div>
          <div className="text-2xl font-bold text-gray-700 dark:text-gray-300">
            {orders.filter(o => {
              const today = new Date().toDateString();
              const orderDate = new Date(o.created_at).toDateString();
              return o.status === 'completed' && today === orderDate;
            }).length}
          </div>
        </div>
      </div>

      {/* Orders Table */}
      <div className="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
        <div className="overflow-x-auto">
          <table className="w-full">
            <thead className="bg-gray-50 dark:bg-gray-700">
              <tr>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Order #</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Customer</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Total</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Date</th>
                <th className="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-gray-200 dark:divide-gray-700">
              {filteredOrders.map(order => (
                <tr key={order.id} className="hover:bg-gray-50 dark:hover:bg-gray-700/50">
                  <td className="px-6 py-4 whitespace-nowrap">
                    <span className="font-mono font-bold text-brand-gold">#{order.order_number}</span>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <div>
                      <div className="font-medium text-gray-900 dark:text-white">{order.customer_name}</div>
                      {order.customer_phone && (
                        <div className="text-sm text-gray-500 dark:text-gray-400">{order.customer_phone}</div>
                      )}
                    </div>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <span className="font-semibold text-gray-900 dark:text-white">
                      {formatPrice(order.total_amount, order.currency)}
                    </span>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <div className="relative inline-block">
                      <select
                        value={order.status}
                        onChange={(e) => updateOrderStatus(order.id, e.target.value as OrderStatus)}
                        disabled={order.status === 'completed' || order.status === 'cancelled'}
                        className={`appearance-none pr-8 pl-3 py-1 text-xs font-medium rounded-full cursor-pointer focus:outline-none focus:ring-2 focus:ring-brand-gold ${STATUS_CONFIG[order.status].color} ${
                          order.status === 'completed' || order.status === 'cancelled' ? 'cursor-not-allowed opacity-75' : ''
                        }`}
                      >
                        {STATUS_OPTIONS.map(status => (
                          <option key={status} value={status}>{STATUS_CONFIG[status].label}</option>
                        ))}
                      </select>
                      <ChevronDown className="absolute right-2 top-1/2 -translate-y-1/2 w-3 h-3 pointer-events-none" />
                    </div>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                    {formatDate(order.created_at)}
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-right">
                    <div className="flex items-center justify-end space-x-2">
                      <button
                        onClick={() => viewOrderDetails(order.id)}
                        className="p-2 text-brand-gold hover:bg-brand-gold/10 rounded-lg transition-colors"
                        title="View Details"
                      >
                        <Eye className="w-4 h-4" />
                      </button>
                      {canDeleteOrders && (order.status === 'pending' || order.status === 'cancelled') && (
                        <button
                          onClick={() => setDeleteConfirm(order.id)}
                          className="p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"
                          title="Delete Order"
                        >
                          <Trash2 className="w-4 h-4" />
                        </button>
                      )}
                    </div>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>

          {filteredOrders.length === 0 && (
            <div className="text-center py-12">
              <p className="text-gray-500 dark:text-gray-400">No orders found</p>
            </div>
          )}
        </div>
      </div>

      {/* Order Detail Modal */}
      <Modal
        isOpen={isDetailModalOpen}
        onClose={() => {
          setIsDetailModalOpen(false);
          setSelectedOrder(null);
        }}
        title={selectedOrder ? `Order #${selectedOrder.order_number}` : 'Order Details'}
      >
        {isLoadingDetail ? (
          <div className="flex justify-center py-8">
            <Spinner />
          </div>
        ) : selectedOrder ? (
          <div className="space-y-6">
            {/* Status */}
            <div className="flex items-center justify-between">
              <span className="text-sm text-gray-500 dark:text-gray-400">Status</span>
              <span className={`px-3 py-1 text-sm font-medium rounded-full flex items-center gap-2 ${STATUS_CONFIG[selectedOrder.status].color}`}>
                {STATUS_CONFIG[selectedOrder.status].icon}
                {STATUS_CONFIG[selectedOrder.status].label}
              </span>
            </div>

            {/* Customer Info */}
            <div className="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 space-y-2">
              <h4 className="font-medium text-gray-900 dark:text-white">Customer Information</h4>
              <div className="grid grid-cols-2 gap-2 text-sm">
                <span className="text-gray-500 dark:text-gray-400">Name:</span>
                <span className="text-gray-900 dark:text-white">{selectedOrder.customer_name}</span>
                
                {selectedOrder.customer_email && (
                  <>
                    <span className="text-gray-500 dark:text-gray-400">Email:</span>
                    <span className="text-gray-900 dark:text-white">{selectedOrder.customer_email}</span>
                  </>
                )}
                
                {selectedOrder.customer_phone && (
                  <>
                    <span className="text-gray-500 dark:text-gray-400">Phone:</span>
                    <span className="text-gray-900 dark:text-white">{selectedOrder.customer_phone}</span>
                  </>
                )}
                
                <span className="text-gray-500 dark:text-gray-400">Date:</span>
                <span className="text-gray-900 dark:text-white">{formatDate(selectedOrder.created_at)}</span>
              </div>
              
              {selectedOrder.notes && (
                <div className="pt-2 border-t dark:border-gray-600">
                  <span className="text-gray-500 dark:text-gray-400 text-sm">Notes: </span>
                  <span className="text-gray-900 dark:text-white text-sm">{selectedOrder.notes}</span>
                </div>
              )}
            </div>

            {/* Order Items */}
            <div>
              <h4 className="font-medium text-gray-900 dark:text-white mb-3">Order Items</h4>
              <div className="space-y-2">
                {selectedOrder.items?.map(item => (
                  <div key={item.id} className="flex justify-between items-center py-2 border-b dark:border-gray-700 last:border-0">
                    <div>
                      <span className="text-gray-900 dark:text-white">{item.product_name}</span>
                      <span className="text-gray-500 dark:text-gray-400 ml-2">√ó {item.quantity}</span>
                    </div>
                    <span className="font-medium text-gray-900 dark:text-white">
                      {formatPrice(item.total_price, item.currency)}
                    </span>
                  </div>
                ))}
              </div>
            </div>

            {/* Total */}
            <div className="flex justify-between items-center pt-4 border-t dark:border-gray-700">
              <span className="text-lg font-semibold text-gray-900 dark:text-white">Total</span>
              <span className="text-2xl font-bold text-brand-gold">
                {formatPrice(selectedOrder.total_amount, selectedOrder.currency)}
              </span>
            </div>

            {/* Actions */}
            {selectedOrder.status !== 'completed' && selectedOrder.status !== 'cancelled' && (
              <div className="flex justify-end space-x-2 pt-4">
                <Button
                  variant="danger"
                  onClick={() => {
                    updateOrderStatus(selectedOrder.id, 'cancelled');
                    setIsDetailModalOpen(false);
                  }}
                >
                  Cancel Order
                </Button>
                {selectedOrder.status === 'ready' && (
                  <Button
                    onClick={() => {
                      updateOrderStatus(selectedOrder.id, 'completed');
                      setIsDetailModalOpen(false);
                    }}
                  >
                    Mark Complete
                  </Button>
                )}
              </div>
            )}
          </div>
        ) : null}
      </Modal>

      {/* Delete Confirmation Modal */}
      <Modal
        isOpen={!!deleteConfirm}
        onClose={() => setDeleteConfirm(null)}
        title="Delete Order"
      >
        <div className="flex items-start space-x-3 mb-6">
          <AlertTriangle className="w-6 h-6 text-red-500 flex-shrink-0" />
          <p className="text-gray-600 dark:text-gray-400">
            Are you sure you want to delete this order? This action cannot be undone.
          </p>
        </div>
        <div className="flex justify-end space-x-3">
          <Button variant="secondary" onClick={() => setDeleteConfirm(null)}>
            Cancel
          </Button>
          <Button variant="danger" onClick={() => deleteConfirm && handleDeleteOrder(deleteConfirm)}>
            <Trash2 className="w-4 h-4 mr-2" />
            Delete
          </Button>
        </div>
      </Modal>
    </div>
  );
}
// File: src/pages/AdminProductsPage.tsx
import { useState, useEffect } from 'react';
import { Plus, Pencil, Trash2, Save, Search, AlertTriangle } from 'lucide-react';
import { Product, CreateProductRequest } from '../types';
import { productsApi } from '../api/products';
import { useToast } from '../hooks/useToast';
import { useAuth } from '../context/AuthContext';
import Button from '../components/ui/Button';
import Input from '../components/ui/Input';
import Modal from '../components/ui/Modal';
import Spinner from '../components/ui/Spinner';
import { formatPrice } from '../utils/currency';

const CATEGORIES = ['Appetizers', 'Main Courses', 'Desserts', 'Beverages'];

interface ProductFormData {
  name: string;
  description: string;
  price: string;
  category: string;
  image_url: string;
  available: boolean;
}

const initialFormData: ProductFormData = {
  name: '',
  description: '',
  price: '',
  category: 'Main Courses',
  image_url: '',
  available: true
};

export default function AdminProductsPage() {
  const [products, setProducts] = useState<Product[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [searchQuery, setSearchQuery] = useState('');
  const [isModalOpen, setIsModalOpen] = useState(false);
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [editingProduct, setEditingProduct] = useState<Product | null>(null);
  const [formData, setFormData] = useState<ProductFormData>(initialFormData);
  const [deleteConfirm, setDeleteConfirm] = useState<string | null>(null);
  const { showToast } = useToast();
  const { user } = useAuth();

  // Only admin can delete
  const canDelete = user?.role === 'admin';

  useEffect(() => {
    fetchProducts();
  }, []);

  const fetchProducts = async () => {
    try {
      const data = await productsApi.getAll();
      setProducts(data);
    } catch (error) {
      showToast('error', 'Failed to load products');
    } finally {
      setIsLoading(false);
    }
  };

  const filteredProducts = products.filter(product =>
    product.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
    product.category.toLowerCase().includes(searchQuery.toLowerCase())
  );

  const openCreateModal = () => {
    setEditingProduct(null);
    setFormData(initialFormData);
    setIsModalOpen(true);
  };

  const openEditModal = (product: Product) => {
    setEditingProduct(product);
    setFormData({
      name: product.name,
      description: product.description || '',
      price: product.price.toString(),
      category: product.category,
      image_url: product.image_url || '',
      available: product.available
    });
    setIsModalOpen(true);
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    
    if (!formData.name.trim()) {
      showToast('error', 'Product name is required');
      return;
    }
    
    if (!formData.price || isNaN(parseFloat(formData.price)) || parseFloat(formData.price) < 0) {
      showToast('error', 'Valid price is required');
      return;
    }

    setIsSubmitting(true);

    try {
      const productData: CreateProductRequest = {
        name: formData.name.trim(),
        description: formData.description.trim() || undefined,
        price: parseFloat(formData.price),
        category: formData.category,
        image_url: formData.image_url.trim() || undefined,
        available: formData.available
      };

      if (editingProduct) {
        await productsApi.update(editingProduct.id, productData);
        showToast('success', 'Product updated successfully');
      } else {
        await productsApi.create(productData);
        showToast('success', 'Product created successfully');
      }

      setIsModalOpen(false);
      fetchProducts();
    } catch (error: any) {
      showToast('error', error.response?.data?.error || 'Failed to save product');
    } finally {
      setIsSubmitting(false);
    }
  };

  const handleDelete = async (id: string) => {
    try {
      await productsApi.delete(id);
      showToast('success', 'Product deleted successfully');
      setDeleteConfirm(null);
      fetchProducts();
    } catch (error: any) {
      showToast('error', error.response?.data?.error || 'Failed to delete product');
    }
  };

  const toggleAvailability = async (product: Product) => {
    try {
      await productsApi.toggleAvailability(product.id, !product.available);
      showToast('success', `Product ${!product.available ? 'enabled' : 'disabled'}`);
      fetchProducts();
    } catch (error) {
      showToast('error', 'Failed to update availability');
    }
  };

  if (isLoading) {
    return (
      <div className="min-h-[60vh] flex items-center justify-center">
        <Spinner size="lg" />
      </div>
    );
  }

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      {/* Header */}
      <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8">
        <div>
          <h1 className="text-2xl font-bold text-gray-900 dark:text-white">Manage Products</h1>
          <p className="text-gray-600 dark:text-gray-400">
            Add, edit, or remove menu items
            {user?.role === 'manager' && (
              <span className="ml-2 text-yellow-600 dark:text-yellow-400 text-sm">
                (Managers cannot delete products)
              </span>
            )}
          </p>
        </div>
        <Button onClick={openCreateModal}>
          <Plus className="w-4 h-4 mr-2" />
          Add Product
        </Button>
      </div>

      {/* Search */}
      <div className="mb-6">
        <div className="relative max-w-md">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
          <input
            type="text"
            placeholder="Search products..."
            value={searchQuery}
            onChange={(e) => setSearchQuery(e.target.value)}
            className="w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 focus:ring-2 focus:ring-brand-gold focus:border-transparent outline-none"
          />
        </div>
      </div>

      {/* Products Table */}
      <div className="bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
        <div className="overflow-x-auto">
          <table className="w-full">
            <thead className="bg-gray-50 dark:bg-gray-700">
              <tr>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Product</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Category</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Price</th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                <th className="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
              </tr>
            </thead>
            <tbody className="divide-y divide-gray-200 dark:divide-gray-700">
              {filteredProducts.map(product => (
                <tr key={product.id} className="hover:bg-gray-50 dark:hover:bg-gray-700/50">
                  <td className="px-6 py-4 whitespace-nowrap">
                    <div className="flex items-center">
                      <div className="w-12 h-12 rounded-lg overflow-hidden flex-shrink-0">
                        {product.image_url ? (
                          <img src={product.image_url} alt={product.name} className="w-full h-full object-cover" />
                        ) : (
                          <div className="w-full h-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center">
                            <span className="text-xl">üçΩÔ∏è</span>
                          </div>
                        )}
                      </div>
                      <div className="ml-4">
                        <div className="font-medium text-gray-900 dark:text-white">{product.name}</div>
                        <div className="text-sm text-gray-500 dark:text-gray-400 max-w-xs truncate">
                          {product.description || 'No description'}
                        </div>
                      </div>
                    </div>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <span className="px-2 py-1 text-xs font-medium bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-full">
                      {product.category}
                    </span>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <span className="font-semibold text-brand-gold">
                      {formatPrice(product.price, product.currency)}
                    </span>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <button
                      onClick={() => toggleAvailability(product)}
                      className={`px-2 py-1 text-xs font-medium rounded-full ${
                        product.available
                          ? 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400'
                          : 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400'
                      }`}
                    >
                      {product.available ? 'Available' : 'Unavailable'}
                    </button>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-right">
                    <div className="flex items-center justify-end space-x-2">
                      <button
                        onClick={() => openEditModal(product)}
                        className="p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors"
                        title="Edit"
                      >
                        <Pencil className="w-4 h-4" />
                      </button>
                      {canDelete && (
                        <button
                          onClick={() => setDeleteConfirm(product.id)}
                          className="p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"
                          title="Delete"
                        >
                          <Trash2 className="w-4 h-4" />
                        </button>
                      )}
                    </div>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>

          {filteredProducts.length === 0 && (
            <div className="text-center py-12">
              <p className="text-gray-500 dark:text-gray-400">No products found</p>
            </div>
          )}
        </div>
      </div>

      {/* Create/Edit Modal */}
      <Modal
        isOpen={isModalOpen}
        onClose={() => setIsModalOpen(false)}
        title={editingProduct ? 'Edit Product' : 'Add New Product'}
      >
        <form onSubmit={handleSubmit} className="space-y-4">
          <Input
            label="Product Name *"
            value={formData.name}
            onChange={(e) => setFormData({ ...formData, name: e.target.value })}
            placeholder="Enter product name"
          />
          
          <div>
            <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
              Description
            </label>
            <textarea
              value={formData.description}
              onChange={(e) => setFormData({ ...formData, description: e.target.value })}
              placeholder="Enter product description"
              rows={3}
              className="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-brand-gold focus:border-transparent outline-none resize-none"
            />
          </div>

          <div className="grid grid-cols-2 gap-4">
            <Input
              label="Price (EGP) *"
              type="number"
              step="0.01"
              min="0"
              value={formData.price}
              onChange={(e) => setFormData({ ...formData, price: e.target.value })}
              placeholder="0.00"
            />
            
            <div>
              <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">
                Category *
              </label>
              <select
                value={formData.category}
                onChange={(e) => setFormData({ ...formData, category: e.target.value })}
                className="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-brand-gold focus:border-transparent outline-none"
              >
                {CATEGORIES.map(cat => (
                  <option key={cat} value={cat}>{cat}</option>
                ))}
              </select>
            </div>
          </div>

          <Input
            label="Image URL"
            type="url"
            value={formData.image_url}
            onChange={(e) => setFormData({ ...formData, image_url: e.target.value })}
            placeholder="https://example.com/image.jpg"
          />

          <div className="flex items-center">
            <input
              type="checkbox"
              id="available"
              checked={formData.available}
              onChange={(e) => setFormData({ ...formData, available: e.target.checked })}
              className="w-4 h-4 text-brand-gold border-gray-300 rounded focus:ring-brand-gold"
            />
            <label htmlFor="available" className="ml-2 text-sm text-gray-700 dark:text-gray-300">
              Available for ordering
            </label>
          </div>

          <div className="flex justify-end space-x-3 pt-4">
            <Button type="button" variant="secondary" onClick={() => setIsModalOpen(false)}>
              Cancel
            </Button>
            <Button type="submit" isLoading={isSubmitting}>
              <Save className="w-4 h-4 mr-2" />
              {editingProduct ? 'Update' : 'Create'}
            </Button>
          </div>
        </form>
      </Modal>

      {/* Delete Confirmation Modal */}
      <Modal
        isOpen={!!deleteConfirm}
        onClose={() => setDeleteConfirm(null)}
        title="Delete Product"
      >
        <div className="flex items-start space-x-3 mb-6">
          <AlertTriangle className="w-6 h-6 text-red-500 flex-shrink-0" />
          <p className="text-gray-600 dark:text-gray-400">
            Are you sure you want to delete this product? This action cannot be undone.
          </p>
        </div>
        <div className="flex justify-end space-x-3">
          <Button variant="secondary" onClick={() => setDeleteConfirm(null)}>
            Cancel
          </Button>
          <Button variant="danger" onClick={() => deleteConfirm && handleDelete(deleteConfirm)}>
            <Trash2 className="w-4 h-4 mr-2" />
            Delete
          </Button>
        </div>
      </Modal>
    </div>
  );
}
// File: src/pages/HomePage.tsx
import { useState, useMemo } from 'react';
import { Search } from 'lucide-react';
import { useTranslation } from 'react-i18next';
import { useProducts } from '../hooks/useProducts';
import { useLanguage } from '../context/LanguageContext';
import ProductList from '../components/products/ProductList';
import CategoryFilter from '../components/products/CategoryFilter';

export default function HomePage() {
  const { products, categories, isLoading, error, filters, updateFilters } = useProducts();
  const [searchQuery, setSearchQuery] = useState('');
  const { t } = useTranslation();
  const { isRTL } = useLanguage();

  const filteredProducts = useMemo(() => {
    if (!searchQuery.trim()) return products;
    
    const query = searchQuery.toLowerCase();
    return products.filter(product => 
      product.name.toLowerCase().includes(query) ||
      product.description?.toLowerCase().includes(query) ||
      product.category.toLowerCase().includes(query)
    );
  }, [products, searchQuery]);

  const handleCategoryChange = (category: string | null) => {
    updateFilters({ category: category || undefined });
  };

  return (
    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      {/* Hero Section */}
      <div className="text-center mb-12">
        <h1 className="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4">
          <span className="text-brand-gold italic">{t('home.title')}</span>
        </h1>
        <p className="text-lg text-gray-600 dark:text-gray-400 max-w-2xl mx-auto">
          {t('home.subtitle')}
        </p>
      </div>

      {/* Search and Filter Bar */}
      <div className="mb-8 space-y-4">
        <div className="flex flex-col sm:flex-row gap-4">
          {/* Search Input */}
          <div className="flex-1 relative">
            <Search className={`absolute top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 ${isRTL ? 'right-3' : 'left-3'}`} />
            <input
              type="text"
              placeholder={t('home.searchPlaceholder')}
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
              className={`w-full py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 focus:ring-2 focus:ring-brand-gold focus:border-transparent outline-none transition-all ${isRTL ? 'pr-10 pl-4' : 'pl-10 pr-4'}`}
            />
          </div>
        </div>

        {/* Category Filters */}
        <CategoryFilter
          categories={categories}
          selected={filters.category || null}
          onSelect={handleCategoryChange}
        />
      </div>

      {/* Results Count */}
      {!isLoading && !error && (
        <p className="text-sm text-gray-600 dark:text-gray-400 mb-4">
          {t('home.showingItems', { count: filteredProducts.length })}
          {filters.category && ` ${t('home.inCategory', { category: filters.category })}`}
          {searchQuery && ` ${t('home.matching', { query: searchQuery })}`}
        </p>
      )}

      {/* Product Grid */}
      <ProductList
        products={filteredProducts}
        isLoading={isLoading}
        error={error}
      />
    </div>
  );
}
// File: src/pages/LoginPage.tsx
import { useState, useEffect } from 'react';
import { useNavigate, useLocation } from 'react-router-dom';
import { LogIn, Eye, EyeOff } from 'lucide-react';
import { useAuth } from '../context/AuthContext';
import { useToast } from '../hooks/useToast';
import Button from '../components/ui/Button';
import Input from '../components/ui/Input';

export default function LoginPage() {
  const navigate = useNavigate();
  const location = useLocation();
  const { login, isAuthenticated, isLoading: authLoading } = useAuth();
  const { showToast } = useToast();

  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const [isLoading, setIsLoading] = useState(false);
  const [errors, setErrors] = useState<{ email?: string; password?: string }>({});

  const from = (location.state as any)?.from?.pathname || '/';

  useEffect(() => {
    if (isAuthenticated && !authLoading) {
      navigate(from, { replace: true });
    }
  }, [isAuthenticated, authLoading, navigate, from]);

  const validateForm = (): boolean => {
    const newErrors: { email?: string; password?: string } = {};

    if (!email.trim()) {
      newErrors.email = 'Email is required';
    } else {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        newErrors.email = 'Invalid email format';
      }
    }

    if (!password) {
      newErrors.password = 'Password is required';
    }

    setErrors(newErrors);
    return Object.keys(newErrors).length === 0;
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!validateForm()) return;

    setIsLoading(true);

    try {
      await login(email, password);
      showToast('success', 'Login successful!');
      navigate(from, { replace: true });
    } catch (error: any) {
      const message = error.response?.data?.error || 'Invalid email or password';
      showToast('error', message);
    } finally {
      setIsLoading(false);
    }
  };

  if (authLoading) {
    return (
      <div className="min-h-[60vh] flex items-center justify-center">
        <div className="animate-spin rounded-full h-12 w-12 border-2 border-gray-300 border-t-brand-gold" />
      </div>
    );
  }

  return (
    <div className="min-h-[80vh] flex items-center justify-center px-4">
      <div className="w-full max-w-md">
        <div className="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8">
          {/* Header */}
          <div className="text-center mb-8">
            <div className="inline-flex items-center justify-center w-16 h-16 bg-brand-gold/10 rounded-full mb-4">
              <LogIn className="w-8 h-8 text-brand-gold" />
            </div>
            <h1 className="text-2xl font-bold text-gray-900 dark:text-white">
              Staff Login
            </h1>
            <p className="text-gray-500 dark:text-gray-400 mt-2">
              Sign in to manage orders
            </p>
          </div>

          {/* Form */}
          <form onSubmit={handleSubmit} className="space-y-6">
            <Input
              label="Email"
              type="email"
              value={email}
              onChange={(e) => {
                setEmail(e.target.value);
                if (errors.email) setErrors(prev => ({ ...prev, email: undefined }));
              }}
              placeholder="admin@restaurant.com"
              error={errors.email}
              disabled={isLoading}
            />

            <div className="relative">
              <Input
                label="Password"
                type={showPassword ? 'text' : 'password'}
                value={password}
                onChange={(e) => {
                  setPassword(e.target.value);
                  if (errors.password) setErrors(prev => ({ ...prev, password: undefined }));
                }}
                placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                error={errors.password}
                disabled={isLoading}
              />
              <button
                type="button"
                onClick={() => setShowPassword(!showPassword)}
                className="absolute right-3 top-8 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"
              >
                {showPassword ? <EyeOff className="w-5 h-5" /> : <Eye className="w-5 h-5" />}
              </button>
            </div>

            <Button
              type="submit"
              isLoading={isLoading}
              className="w-full"
              size="lg"
            >
              Sign In
            </Button>
          </form>

          {/* Demo Credentials */}
          <div className="mt-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg">
            <p className="text-sm text-gray-600 dark:text-gray-400 text-center">
              <span className="font-medium">Demo credentials:</span>
              <br />
              admin@restaurant.com / admin123
            </p>
          </div>
        </div>
      </div>
    </div>
  );
}
// File: src/pages/OrderSuccessPage.tsx
import { useEffect } from 'react';
import { useLocation, useNavigate, Link } from 'react-router-dom';
import { CheckCircle, ArrowLeft, Clock, User, Phone, Mail, FileText } from 'lucide-react';
import type { Order } from '../types';
import { formatPrice } from '../utils/currency';
import Button from '../components/ui/Button';

export default function OrderSuccessPage() {
  const location = useLocation();
  const navigate = useNavigate();
  const order = location.state?.order as Order | undefined;

  useEffect(() => {
    // Redirect to home if no order data
    if (!order) {
      navigate('/', { replace: true });
    }
  }, [order, navigate]);

  if (!order) {
    return null;
  }

  return (
    <div className="min-h-[80vh] flex items-center justify-center px-4 py-12">
      <div className="w-full max-w-lg">
        <div className="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8 text-center">
          {/* Success Icon */}
          <div className="inline-flex items-center justify-center w-20 h-20 bg-green-100 dark:bg-green-900/30 rounded-full mb-6">
            <CheckCircle className="w-10 h-10 text-green-500" />
          </div>

          {/* Header */}
          <h1 className="text-3xl font-bold text-gray-900 dark:text-white mb-2">
            Order Placed!
          </h1>
          <p className="text-gray-500 dark:text-gray-400 mb-6">
            Thank you for your order. Your food will be ready soon!
          </p>

          {/* Order Number */}
          <div className="bg-brand-gold/10 rounded-xl p-4 mb-6">
            <p className="text-sm text-brand-gold font-medium mb-1">Order Number</p>
            <p className="text-3xl font-bold text-brand-gold">#{order.order_number}</p>
          </div>

          {/* Order Details */}
          <div className="bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4 mb-6 text-left space-y-3">
            <div className="flex items-center text-gray-600 dark:text-gray-400">
              <User className="w-5 h-5 mr-3" />
              <span>{order.customer_name}</span>
            </div>
            
            {order.customer_email && (
              <div className="flex items-center text-gray-600 dark:text-gray-400">
                <Mail className="w-5 h-5 mr-3" />
                <span>{order.customer_email}</span>
              </div>
            )}
            
            {order.customer_phone && (
              <div className="flex items-center text-gray-600 dark:text-gray-400">
                <Phone className="w-5 h-5 mr-3" />
                <span>{order.customer_phone}</span>
              </div>
            )}
            
            {order.notes && (
              <div className="flex items-start text-gray-600 dark:text-gray-400">
                <FileText className="w-5 h-5 mr-3 mt-0.5" />
                <span>{order.notes}</span>
              </div>
            )}
            
            <div className="flex items-center text-gray-600 dark:text-gray-400">
              <Clock className="w-5 h-5 mr-3" />
              <span>Status: <span className="capitalize font-medium text-yellow-600">{order.status}</span></span>
            </div>
          </div>

          {/* Total */}
          <div className="flex justify-between items-center py-4 border-t dark:border-gray-700">
            <span className="text-lg font-medium text-gray-700 dark:text-gray-300">Total Amount</span>
            <span className="text-2xl font-bold text-brand-gold">
              {formatPrice(order.total_amount, order.currency)}
            </span>
          </div>

          {/* Actions */}
          <div className="mt-6 space-y-3">
            <Link to="/" className="block">
              <Button className="w-full" size="lg">
                <ArrowLeft className="w-4 h-4 mr-2" />
                Continue Ordering
              </Button>
            </Link>
          </div>
        </div>
      </div>
    </div>
  );
}
// File: src/types/index.ts
// Currency types
export type Currency = 'USD' | 'EUR' | 'GBP' | 'EGP' | 'SAR' | 'AED' | 'JPY' | 'CAD' | 'AUD';

export const CURRENCY_SYMBOLS: Record<Currency, string> = {
  USD: '$',
  EUR: '‚Ç¨',
  GBP: '¬£',
  EGP: 'E¬£',
  SAR: 'Ô∑º',
  AED: 'ÿØ.ÿ•',
  JPY: '¬•',
  CAD: 'C$',
  AUD: 'A$'
};

// User types
export type UserRole = 'admin' | 'manager' | 'cashier';

export interface User {
  id: string;
  email: string;
  name: string;
  role: UserRole;
  is_active: boolean;
  created_at: string;
  updated_at: string;
}

export interface AuthResponse {
  user: User;
  accessToken: string;
  refreshToken: string;
}

// Product types
export interface Product {
  id: string;
  name: string;
  description: string | null;
  price: number;
  currency: Currency;
  image_url: string | null;
  category: string;
  available: boolean;
  created_at: string;
  updated_at: string;
}

export interface CreateProductRequest {
  name: string;
  description?: string;
  price: number;
  currency?: Currency;
  image_url?: string;
  category: string;
  available?: boolean;
}

// Cart types
export interface CartItem {
  product: Product;
  quantity: number;
}

// Order types
export type OrderStatus = 
  | 'pending' 
  | 'confirmed' 
  | 'preparing' 
  | 'ready' 
  | 'completed' 
  | 'cancelled';

export interface OrderItem {
  id: string;
  order_id: string;
  product_id: string;
  product_name: string;
  quantity: number;
  unit_price: number;
  currency: Currency;
  total_price: number;
  created_at: string;
}

export interface Order {
  id: string;
  order_number: number;
  customer_name: string;
  customer_email: string | null;
  customer_phone: string | null;
  total_amount: number;
  currency: Currency;
  status: OrderStatus;
  notes: string | null;
  created_at: string;
  updated_at: string;
}

export interface OrderWithItems extends Order {
  items: OrderItem[];
}

export interface CreateOrderRequest {
  customer_name: string;
  customer_email?: string;
  customer_phone?: string;
  items: { product_id: string; quantity: number }[];
  notes?: string;
}

// API Response
export interface ApiResponse<T> {
  success: boolean;
  data?: T;
  count?: number;
  message?: string;
  error?: string;
}
// File: src/utils/currency.ts
import { Currency, CURRENCY_SYMBOLS } from '../types';

export const formatPrice = (price: number, currency: Currency = 'EGP'): string => {
  const symbol = CURRENCY_SYMBOLS[currency] || currency;
  
  // Format number with commas
  const formattedNumber = price.toLocaleString('en-US', {
    minimumFractionDigits: 2,
    maximumFractionDigits: 2
  });
  
  return `${symbol}${formattedNumber}`;
};

export const getCurrencySymbol = (currency: Currency): string => {
  return CURRENCY_SYMBOLS[currency] || currency;
};
